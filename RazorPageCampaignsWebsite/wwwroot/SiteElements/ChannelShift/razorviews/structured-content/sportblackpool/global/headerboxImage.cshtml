@{

    // Name: Channel Shift - Structured Content (Content types)
    // Developer: Asif Nissar
    // Name: headerbox Image - used in sports blackpool pages
    // License: Blackpool council
    // Date: 11/06/2018
}


@using System;
@using System.Collections;
@using Contensis.Framework.Web
@using Newtonsoft.Json
@using Zengenti.Contensis.Delivery;
@using Zengenti.Data;

@using Blackpool.Zengenti.CMS.Common;
@using Blackpool.Zengenti.CMS.Modules.Configuration;
@using Blackpool.Zengenti.CMS.Helpers;
@using Blackpool.Zengenti.CMS.Models.BlackpoolSport;
@using Blackpool.Zengenti.CMS.Models.Venues;
@using Blackpool.Zengenti.CMS.Models.GenericTypes;
@using Blackpool.Zengenti.CMS.Models.Components;
@using Blackpool.Zengenti.CMS.Constants;

@{
    SportBlackPoolDTO DTO = Page.Model;
    SerialisedItem serialisedItem = null;
    string Title = string.Empty;
    string displayText = "display:none;";

    bool ExceptionIamage = false;
    int defaultBorderWidth= 75;
    ImageHeaderBox box = null;
    HeaderStrapLine hsl = null;


    string headerImageBox = DTO.NoImageUrl;
    if (DTO.Flow != null)
    {
        foreach (var item in DTO.Flow.GetContent)
        {
            var list = item.Items.FindAll(x => x.ClassType == typeof(ImageHeaderBox));
            if (list != null && list.Count > 0)
            {
                serialisedItem = list[0];
                box = SerializeHelper.Deseralize(serialisedItem) as ImageHeaderBox;
                break;
            }
        }
        foreach (var item in DTO.Flow.GetContent)
        {
            var list = item.Items.FindAll(x => x.ClassType == typeof(HeaderStrapLine));
            if (list != null && list.Count > 0)
            {
                serialisedItem = list[0];
                hsl = SerializeHelper.Deseralize(serialisedItem) as HeaderStrapLine;
                break;
            }
        }

        headerImageBox = (box != null && box.Image != null && box.Image.Asset != null)
            ? String.Format("{0}{1}", DTO.BaseImageUrl, box.Image.Asset.Uri) : headerImageBox;

        Title = (DTO.CurrentItemPageType == SportBlackpoolPageTypes.TopLevel) ? string.Empty : DTO.CurrentItem.Title;
        displayText = (hsl != null && hsl.StrapLine.Length > 0) ? displayText : "";

        //add exception
        if (Title != string.Empty && Title.ToLower().Trim().Contains("business health matters"))
        {
            displayText = "display:none;";
            defaultBorderWidth = 0;
        }
    }

}
<style type="text/css">
        div.container-image {
             background-attachment: scroll;
             background-position: center;
             background-size: cover;
             background-image: url('@Html.Raw(headerImageBox)');
             position:relative;
             border-bottom: solid 0px #fff;
             max-height: @String.Format("{0}px", (DTO.CurrentItemPageType == SportBlackpoolPageTypes.TopLevel) ? 450 : 250);
             height:  @String.Format("{0}px", (DTO.CurrentItemPageType == SportBlackpoolPageTypes.TopLevel) ? 450 : 250);
             border:solid;

         }


</style>

<div class="container-image clearfix">
    <div class="centered-text" style="@String.Format("{0}", displayText)">
        @if (hsl != null && hsl.ShowHeader)
        {
            <h1>@String.Format("{0}", (hsl.Header != null) ? hsl.Header : String.Empty)</h1>
            @Html.Raw(String.Format("{0}", (hsl.StrapLine != null) ? hsl.StrapLine : String.Empty))
        }
        else
        {
            if (Title != string.Empty)
            {
                <h1>@String.Format("{0}", Title)</h1>
            }

        }
        &nbsp;
    </div>
    <div class="diagonal-div"></div>

</div>


<style type="text/css">


    div.container-image > .diagonal-div {
        border: 0;
        padding: 0;
        margin: 0;
        width: 100%;
        height: 0;
        border-style: solid;
        border-width: @String.Format("{0}px 200vw 0 0", (DTO.CurrentItemPageType == SportBlackpoolPageTypes.TopLevel) ? 120 : defaultBorderWidth);
        border-color: transparent #fff transparent transparent;
        position: absolute;
        bottom: 0;
    }

    div#ontent-full-width h1 {
        color:#
    }
</style>



