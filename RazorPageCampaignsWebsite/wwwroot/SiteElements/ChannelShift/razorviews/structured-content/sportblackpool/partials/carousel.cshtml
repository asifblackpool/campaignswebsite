@{

    // Name: Channel Shift - Structured Content (Content types)
    // Developer: Asif Nissar
    // Name: Carousel Image - used in sports blackpool pages
    // License: Blackpool council
    // Date: 11/06/2018
}


@using System;
@using System.Collections;
@using Contensis.Framework.Web
@using Newtonsoft.Json
@using Zengenti.Contensis.Delivery;
@using Zengenti.Data;

@using Blackpool.Zengenti.CMS.Common;
@using Blackpool.Zengenti.CMS.Modules.Configuration;
@using Blackpool.Zengenti.CMS.Helpers;
@using Blackpool.Zengenti.CMS.Models.BlackpoolSport;
@using Blackpool.Zengenti.CMS.Models.GenericTypes;
@using Blackpool.Zengenti.CMS.Models.Components;
@using Blackpool.Zengenti.CMS.Constants;


@{
    SportBlackPoolDTO DTO = Page.Model;
    List<ImageBox> carousel = new List<ImageBox>();
    SportBlackpoolHelper helper = null;
    Config config = DTO.Config;
    PagedList<SportBlackpool> list = DTO.List;

    if (DTO.Flow != null){
        helper = (list != null) ? new SportBlackpoolHelper(list.Items) : new SportBlackpoolHelper(null);
        foreach (var item in DTO.Flow.GetContent){
            List<SerialisedItem> SerailisedList = item.Items.FindAll(x => x.ClassType == typeof(ImageBox) && x.ContainerType == ComponentKeys.CAROUSEL);
            if (SerailisedList != null){
                foreach (SerialisedItem si in SerailisedList) {
                    ImageBox temp = SerializeHelper.Deseralize(si) as ImageBox;
                    carousel.Add(temp);
                }
            }
        }
    }
}
   
@if (carousel != null && carousel.Count > 0) { 
    <div class="row zero-margin-all clearfix">
    <div class="col-md-12 zero-pad-all">
    <section class="center slider">
        @foreach (var item in carousel){
            string href = (item.LinkedEntry != null && item.ExternalURL == null) ? String.Format("{0}", helper.NavigationBuilder(item.LinkedItem, config.SeoUrlList.UrlPath)): item.ExternalURL;
            string img = (item.Image != null && item.Image.Asset != null) ? DTO.BaseImageUrl + item.Image.Asset.Uri.ToString() : String.Empty;
           <div><a href="@href"><img src="@string.Format("{0}?text={1}", img, item.Title)" alt="@item.Title"></a></div>
        }
    </section>
    </div>
    </div>
    <script type="text/javascript">
        $(document).ready(function () {
            $("section.center").slick({
                dots: true,
                centerMode: true,
                centerPadding: '0px'
            });
        });
    </script>
}




