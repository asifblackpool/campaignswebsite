;"use strict",function(a,b,c){function f(a,b,c){var d=new Date,e=new Date;if(c===null||c===0)c=1;e.setTime(d.getTime()+864e5*c),document.cookie=a+"="+window.escape(b)+";expires="+e.toGMTString()}function g(a){try{var b=" "+document.cookie,c=b.indexOf(" "+a+"=");c===-1&&(c=b.indexOf(";"+a+"="));if(c===-1||a==="")return"";var d=b.indexOf(";",c+1);return d===-1&&(d=b.length),window.unescape(b.substring(c+a.length+2,d))}catch(e){return"error"}}var d="outdatedbrowser",e="set",h=!1,i=function(){var a=this,b=navigator.userAgent.toLowerCase();b.indexOf("msie")!==-1&&(a.ie={version:parseInt(b.split("msie")[1].trim().substr(0,1))})},j=function(){try{var a=function(a){try{var c=document.getElementById(a);c.addEventListener("load",function(){c.style="cursor:pointer;";var a=c.contentDocument;a.onclick=function(a){b("#outdated-browser").css("display","none"),f(d,e,240),a.preventDefault()}},!1)}catch(g){}};a("close-button-svg");if(i!==null&&i.ie.version<9){var c=g(d);c!==e&&(a("close-button-svg"),b("#outdated-browser").css("display","block"))}}catch(h){}},k=function(){i.ie&&i.ie.version<10&&(console.log("IE "+i.ie+" version "+i.ie.version),h=!0),h&&(console.log("replace place holders"),b("input[placeholder]").each(function(){var a=b(this);b(a).val(a.attr("placeholder")),b(a).focus(function(){a.val()===a.attr("placeholder")&&a.val("")}),b(a).blur(function(){(a.val()===""||a.val()===a.attr("placeholder"))&&a.val(a.attr("placeholder"))})}))};a.init=function(){k(),j()}}(window.ieBrowser=window.ieBrowser||{},jQuery)
;"use strict",function(a,b,c){var d=function(){b(window).scroll(function(){b(this).scrollTop()>100?b(".scrollToTop").fadeIn():b(".scrollToTop").fadeOut()}),b(".scrollToTop").click(function(a){return b("html, body").animate({scrollTop:0},800),a.preventDefault(),!1})},e=function(a,c){var d=b("."+a).position();return b("html, body").animate({scrollTop:d.top},800),c.preventDefault(),!1};a.init=function(){d()},a.ScrollToByClass=function(a,b){return e(a,b)}}(window.scrollerservice=window.scrollerservice||{},jQuery)
;"use strict",function(a,b,c){var d="table.tbl-responsive",e=function(){var a=[],b=document.querySelectorAll(d+" th"),c=document.querySelectorAll(d+" tr");for(var e=0;e<b.length;e++){var f=b[e];a.push(f.textContent.replace(/\r?\n|\r/,""))}for(var g=0;g<c.length;g++){var h=c[g];for(var i=0;i<h.length;i++){var j=h.cells[i];j.setAttribute("data-th",a[i])}}};a.init=function(){e()}}(window.tableservices=window.tableservices||{},jQuery)
;"use strict";var utilities=function(a){var b={dropdown:{},unorderdList:{},helper:{}};return b.dropdown.appendOptions=function(b,c){var d=a("#"+b);d.append(a(new Option("-- Please Select --","0"))),a.each(c,function(b,c){d.append(a(new Option(c.Text,c.Value)))})},b.dropdown.removeAllOptions=function(b){a("#"+b).empty()},b.unorderdList.appendList=function(b,c){a.each(c,function(c,d){a("#"+b).append("<li>"+d.Text+"</li>")})},b.splitString=function(a,b){try{var c=a.split(",");return c.length>b?c[b]:a}catch(d){alert("module.splitString() => error: "+d.message)}},b.validateUKPostCode=function(a){if(a!==""&&a.length>2){var b=a.substring(0,2).toUpperCase(),c=/^(FY)/;if(!b.match(c))return"Post code must start with FY.";a=a.replace(/\s/g,"");var d=/[A-Z]{1,2}[0-9][0-9A-Z]?\s?[0-9][A-Z]{2}/gi,e=d.test(a);return e?"":"You have entered an invalid post code for Blackpool."}return"Please provide a valid Blackpool post code."},b.validateEmailAddress=function(a){var b=/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;return b.test(a)?"":"Please provide a valid email address."},b.searchQuery=function(a){var b=a.trim();b!==""&&(document.location.href="/Search-Results.aspx?search_keywords="+encodeURIComponent(b))},b.ajaxRequest=function(){var a=["Msxml2.XMLHTTP","Microsoft.XMLHTTP"];if(!window.ActiveXObject)return window.XMLHttpRequest?new XMLHttpRequest:null;for(var b=0;b<a.length;b++)try{return new window.ActiveXObject(a[b])}catch(c){}},b.helper.sortObjArray=function(a,b){a.sort(function c(a,c){return a[b]<c[b]?-1:a[b]>c[b]?1:0})},b.helper.removeDuplicatesFromObjArray=function(a,b){var c=[];return a.reduce(function(a,d){if(a[b]!==d[b])return c.push(d),d},[]),c},b}(jQuery);(function(a,b,c){var d={search:!1,menu:!1},e=null,f=function(){var a=!1,c=function(){d.menu=!0,i(),b("#menu-anchor-icon").toggleClass("mobile-nav-icon mobile-close-icon"),h()},f=function(){i(),b("#menu-anchor-icon").toggleClass("mobile-nav-icon mobile-close-icon"),d.menu=!1},g=function(){a?(b.sidr("open","sidr-menu"),a=!1):(b.sidr("close","sidr-menu"),a=!0)};e=b("#toggle-menu").sidr({name:"sidr-menu",side:"right",source:"#navigation",displace:!0,speed:"200",onOpen:function(){c()},onClose:function(){f()}}),b("#toggle-menu").on("click",function(a){g(),a.preventDefault(),a.stopPropagation()}),g()},g=function(){b("#toggle-search").click(function(){return i(),d.search||b("#search-box-inner").css({height:"155px"}),b(".toggle-search").toggle("slow"),b("#search-anchor-icon").toggleClass("mobile-search-icon mobile-close-icon"),d.search=!d.search,!1}),b("#home-show-hide-services").click(function(){var a=function(){var a={id:"more-services-icon",up:"arrowup-white.svg",down:"arrowdown-white.svg",path:"/SiteElements/ChannelShift/content/images/mobile/"},c=b("#"+a.id).attr("src"),d=c.substr(c.lastIndexOf("/")+1);d==="arrowdown-white.svg"?(b(".home-icon").find("*").removeClass("mobile-hidden"),b("#"+a.id).attr("src",a.path+a.up)):(b(".home-icon").find("div:nth-child(n+7)").addClass("mobile-hidden"),b("#"+a.id).attr("src",a.path+a.down))};a()})},h=function(){b("#search-anchor-icon").removeClass(),b("#search-anchor-icon").addClass("mobile-search-icon"),d.search&&(b(".toggle-search").toggle("slow"),d.search=!1)},i=function(){b("#search-box-inner").css({height:""}),d.menu&&e.click()};a.init=function(){console.log("home services initialisation"),f(),g()}})(window.homeservices=window.homeservices||{},jQuery)
;"use strict",function(a,b,c){var d={down:"icon-arrow-down",up:"icon-arrow-up"},e=function(a){var b=a.className;a.className=b===d.down?d.up:d.down},f=function(){var a="",c=null,e=null;b(".accordion-togglable").each(function(f,g){e=g.parentElement.getElementsByTagName("i")[0],c=b(g).parent().closest("li").find("a.link-head"),c[0].className="link-head",a=e.className,a===d.up&&(e.className=d.down)})},g=function(a){var c=null,d=b(a).closest("li").find(".accordion-togglable")[0],g=d.parentElement.getElementsByTagName("i")[0];f(),c=b(d).parent().closest("li").find("a.link-head"),c[0].className="link-head open",b(a).closest("li").find(".accordion-togglable").not(":animated").slideToggle(function(){e(g)})},h=function(a){var c="",d=null,e=1;b(".accordion-togglable").each(function(b,f){d=f.parentElement.getElementsByTagName("i")[0],c=d.className,e==a&&g(this),e++})},i=function(){b(document).off("click","#accordion-ul .head a.link-head")},j=function(){b(document).on("click","#accordion-ul .head a.link-head",function(a){a.preventDefault(),b(".accordion-togglable").hide(500),g(this)}),b(document).on("click","div.accordion-togglable a",function(a){a.stopPropagation()})};a.init=function(){i(),j()},a.open=function(a){h(a)}}(window.accordionservices=window.accordionservices||{},jQuery)
;(function(a,b,c){var d=function(a,c,d){var e=function(a,b){b.indexOf("down")>0?(a.removeClass("down"),a.addClass("up")):(a.removeClass("up"),a.addClass("down"))};b("#"+a).slideToggle("slow",function(){e(c,d)})},e=function(){b("h4#change-pin").on("click",function(a){var c=b(this).find("span:first");d("change-pin-container",c,c.attr("class"))})},f=function(){b("h4#preferences").on("click",function(a){var c=b(this).find("span:first");d("preferences-container",c,c.attr("class"))})};a.init=function(){e(),f()}})(window.togglelibraryservices=window.togglelibraryservices||{},jQuery)
;"use strict",function(a,b,c){function g(a){typeof console!="undefined"&&console.log(a)}function h(a,b,c){c=typeof c=="undefined"?"name":c;for(var d=0;d<a.length;d++)if(a[d][c]===b)return a[d];return null}function i(a){return function(b,c){return b[a]>c[a]?1:b[a]<c[a]?-1:0}}var d=new Array,e=50,f=null,j=function(a,b){var c=b?b:window.location.href,d=new RegExp("[?&]"+a+"=([^&#]*)","i"),e=d.exec(c);return e?e[1]:null},k=function(a,b){if(a!==null){var c=a.length;if(c>b)return a.substring(0,b)}return a},l=function(a,c,d){var e=b("<select id='"+a+"' />");return b("<option />",{value:c,text:d}).appendTo(e),e},m=function(a){var c=[];return Array.isArray(a)?b.each(a,function(a,b){c.push(b)}):c.push(a),c},n=function(){var a={handlebarIDs:{pickuplocation:"pickup-location-template",yourstatus:"your-status-template"},contentIDs:{pickuplocation:"pickup-location-content",yourstatus:"your-status-content"},populatePickupLocation:function(a){b("#"+this.contentIDs.searchContainer).hide();var c=Handlebars.compile(b("#"+this.handlebarIDs.pickuplocation).html()),d=c({apidata:a.data,apiview:a.viewmode});b("#"+this.contentIDs.pickuplocation).html(d),b("#"+this.contentIDs.pickuplocation).show(),w(this.contentIDs.pickuplocation,!1)},populateYourStatus:function(a){var c=Handlebars.compile(b("#"+this.handlebarIDs.yourstatus).html()),d=c({apidata:a});b("#"+this.contentIDs.yourstatus).html(d),b("#"+this.contentIDs.yourstatus).show()},clearYourStatus:function(){b("#"+this.contentIDs.yourstatus).html(""),b("#"+this.contentIDs.yourstatus).hide()},clearPickupLocation:function(){b("#"+this.contentIDs.pickuplocation).html(""),b("#"+a.contentIDs.pickuplocation).hide()},reset:function(){this.clearPickupLocation(),this.clearYourStatus()}};return a},o=function(){var a={handlebarIDs:{results:"search-book-results-template",pagination:"search-book-pagination-template",availability:"availability-catalog-template",availabilityPartial:"availability-information-partial",whatsNew:"whats-new-template",advancedSearch:"advanced-search-template"},contentIDs:{results:"catalog-results-content",paginationTop:"catalog-pagination-content-top",paginationBottom:"catalog-pagination-content-bottom",availability:"catalog-availability-content",searchcatalog:"search-catalog",searchContainer:"library-search-container",whatsNew:"whats-new-content",advancedSearch:"advanced-search-form-content"},populateResults:function(a){var c=Handlebars.compile(b("#"+this.handlebarIDs.results).html()),d=c({apidata:a});b("#"+this.contentIDs.searchcatalog).show(),b("#"+this.contentIDs.results).html(d),w(this.contentIDs.searchcatalog,!1)},populatePagination:function(a,c){b("#"+this.contentIDs.searchContainer).show();var d=Handlebars.compile(b("#"+this.handlebarIDs.pagination).html()),e=d({apipages:a,apirecords:c,apilocation:"top"}),f=d({apipages:a,apirecords:c,apilocation:"bottom"});b("#"+this.contentIDs.paginationTop).html(e),b("#"+this.contentIDs.paginationBottom).html(f)},populateAvailability:function(a){b("#"+this.contentIDs.searchContainer).hide();var c=Handlebars.compile(b("#"+this.handlebarIDs.availability).html());Handlebars.registerPartial(this.handlebarIDs.availabilityPartial,b("#"+this.handlebarIDs.availabilityPartial).html());var d=c({apidata:a.TitleInfo});b("#"+this.contentIDs.availability).html(d)},populateAdvancedSearch:function(){b("#"+this.contentIDs.advancedSearch).show();var a=Handlebars.compile(b("#"+this.handlebarIDs.advancedSearch).html()),c=a({apidata:null});b("#"+this.contentIDs.advancedSearch).html(c),w(this.contentIDs.advancedSearch,!1)},populateWhatsNew:function(a,c){var d=Handlebars.compile(b("#"+this.handlebarIDs.whatsNew).html()),e=d({apilist:a,apidata:c});b("#"+this.contentIDs.whatsNew).html(e),w(this.contentIDs.whatsNew,!1)},clearResults:function(){b("#"+this.contentIDs.results).html("")},clearSearchInputBox:function(){b("#library-search").val("")},clearPagination:function(){b("#"+this.contentIDs.paginationTop).html(""),b("#"+this.contentIDs.paginationBottom).html("")},clearAvailabilty:function(){b("#"+this.contentIDs.availability).html("")},clearAdvancedSearch:function(){b("#"+this.contentIDs.advancedSearch).html("")},clearWhatsNew:function(){b("#"+this.contentIDs.whatsNew).html("")},showSearchInput:function(){b("#"+a.contentIDs.searchContainer).show()},hideSearchInput:function(){b("#"+a.contentIDs.searchContainer).hide()},reset:function(){this.clearPagination(),this.clearAvailabilty(),this.clearResults(),this.clearWhatsNew()}};return a},p=function(){var a={handlebarIDs:{account:{main:"account-template",location:"edit-location-template",suspend:"suspend-item-template",partials:{mydetails:"mydetails-partial",changepin:"changepin-partial",preferences:"preferences-partial",onloan:"onloan-partial",onhold:"onhold-partial",mylist:"mylist-partial",mylistemail:"mylist-email-partial",fines:"fines-partial"}}},contentIDs:{account:"account-content",location:"account-location-content",mylist:{email:"email-mylist-container",main:"mylist-container"},suspend:"suspend-content"},populateAccount:function(a,c){var d=Handlebars.compile(b("#"+this.handlebarIDs.account.main).html());Handlebars.registerPartial(this.handlebarIDs.account.partials.mydetails,b("#"+this.handlebarIDs.account.partials.mydetails).html()),Handlebars.registerPartial(this.handlebarIDs.account.partials.changepin,b("#"+this.handlebarIDs.account.partials.changepin).html()),Handlebars.registerPartial(this.handlebarIDs.account.partials.preferences,b("#"+this.handlebarIDs.account.partials.preferences).html()),Handlebars.registerPartial(this.handlebarIDs.account.partials.onloan,b("#"+this.handlebarIDs.account.partials.onloan).html()),Handlebars.registerPartial(this.handlebarIDs.account.partials.onhold,b("#"+this.handlebarIDs.account.partials.onhold).html()),Handlebars.registerPartial(this.handlebarIDs.account.partials.mylist,b("#"+this.handlebarIDs.account.partials.mylist).html()),Handlebars.registerPartial(this.handlebarIDs.account.partials.mylistemail,b("#"+this.handlebarIDs.account.partials.mylistemail).html()),Handlebars.registerPartial(this.handlebarIDs.account.partials.fines,b("#"+this.handlebarIDs.account.partials.fines).html());var e=d({apiAccountInfo:a,apiMyList:c});b("#"+this.contentIDs.account).html(e),this.setPageTitle("My library account")},clearAccount:function(){b("#"+this.contentIDs.account).html("")},hideAccount:function(){b("#"+this.contentIDs.account).hide()},showAccount:function(){b("#"+this.contentIDs.account).show()},populateLocation:function(a){var c=Handlebars.compile(b("#"+this.handlebarIDs.account.location).html()),d=c({apidata:a});b("#"+this.contentIDs.location).html(d),w(this.contentIDs.location,!1),this.setPageTitle("My library account")},populateSuspend:function(a){var c=Handlebars.compile(b("#"+this.handlebarIDs.account.suspend).html()),d=c({apidata:a});b("#"+this.contentIDs.suspend).html(d),w(this.contentIDs.suspend,!1),this.setPageTitle("My library account")},clearLocation:function(){b("#"+this.contentIDs.location).html("")},clearSuspend:function(){b("#"+this.contentIDs.suspend).html("")},hideLocation:function(){b("#"+this.contentIDs.location).hide()},showLocation:function(){b("#"+this.contentIDs.location).show()},hideSuspend:function(){b("#"+this.contentIDs.suspend).hide()},showSuspend:function(){b("#"+this.contentIDs.suspend).show()},setPageTitle:function(a){b(".library-h1-title").html(a)},reset:function(){this.clearAccount(),this.clearSuspend(),this.clearLocation(),this.hideAccount(),this.hideLocation(),this.hideSuspend()}};return a},q=function(){var a={handlebarIDs:{login:"login-template",loginlink:"loginlink-template",partials:{resetPin:"resetpin-partial",resetPinConfirm:"resetpin-confirm-partial"}},contentIDs:{login:"login-content",loginlink:"library-login-link",forms:{login:"login-form",resetpin:"resetpin-form",resetpinconfirm:"resetpin-confirm-form"}},populateLogin:function(a){var c={};c.urls=a;var d=Handlebars.compile(b("#"+this.handlebarIDs.login).html());Handlebars.registerPartial(this.handlebarIDs.partials.resetPin,b("#"+this.handlebarIDs.partials.resetPin).html()),Handlebars.registerPartial(this.handlebarIDs.partials.resetPinConfirm,b("#"+this.handlebarIDs.partials.resetPinConfirm).html());var e=d({apidata:c});b("#"+this.contentIDs.login).html(e),w(this.contentIDs.login,!1),this.setPageTitle("Log into your library account")},populateLoginLink:function(a,c){var d={};d.user=a,d.urls=c;var e=Handlebars.compile(b("#"+this.handlebarIDs.loginlink).html()),f=e({apidata:d});b("#"+this.contentIDs.loginlink).html(f)},showLogin:function(){b("#"+this.contentIDs.forms.login).show()},hideLogin:function(){b("#"+this.contentIDs.forms.login).hide()},showResetPin:function(){b("#"+this.contentIDs.forms.resetpin).show()},hideResetPin:function(){b("#"+this.contentIDs.forms.resetpin).show()},showResetPinConfirm:function(){b("#"+this.contentIDs.forms.resetpinconfirm).show()},hideResetPinConfirm:function(){b("#"+this.contentIDs.forms.resetpinconfirm).hide()},clearLogin:function(){b("#"+this.contentIDs.login).html("")},clearLoginLink:function(){b("#"+this.contentIDs.loginlink).html("")},setPageTitle:function(a){b(".library-h1-title").html(a)},reset:function(){}};return a},r=function(){var a={contentIDs:{overlay:"library-overlay-text"},populateOverlay:function(a){b("#"+this.contentIDs.overlay).html(a)},clearOverlay:function(){b("#"+this.contentIDs.overlay).html("")},reset:function(){}};return a},s=function(){b("#library-loading-indicator").hide()},t=function(){return d.push({value:"Anchorsholme",key:"ANC"}),d.push({value:"Boundary",key:"BOU"}),d.push({value:"Central",key:"CEN"}),d.push({value:"Layton",key:"LAY"}),d.push({value:"Mereside",key:"MER"}),d.push({value:"Moor Park",key:"MOR"}),d.push({value:"Palatine",key:"PAL"}),d.push({value:"Revoe",key:"REV"}),d},u=function(){var a={SEARCH_DEFAULT:0,SEARCH:1,ITEM_DETAIL:2,PICKUP_LOCATION:3,LOGIN:4,ADV_SEARCH:5,ACCOUNT:6,FORGOTTEN_PASSWORD:7};return a},v=function(a){window.cookieservices.EraseCookie("contentview"),window.cookieservices.CreateCookie("contentview",a,.05)},w=function(a,c){var d=c?".":"#";b("html,body").animate({scrollTop:b(d+a).offset().top-100},"slow")},x=function(a){switch(a){case u().SEARCH_DEFAULT:b("#library-search-container").show(),b("#"+o().contentIDs.searchcatalog).hide(),b("#"+o().contentIDs.availability).hide(),b("#"+n().contentIDs.pickuplocation).hide(),b("#"+o().contentIDs.advancedSearch).hide(),b("#"+o().contentIDs.whatsNew).show(),w(o().contentIDs.whatsNew,!1);break;case u().SEARCH:b("#library-search-container").show(),b("#"+o().contentIDs.searchcatalog).show(),b("#"+o().contentIDs.availability).hide(),b("#"+n().contentIDs.pickuplocation).hide(),b("#"+o().contentIDs.advancedSearch).hide(),b("#"+o().contentIDs.whatsNew).hide(),w(o().contentIDs.searchcatalog,!1);break;case u().ITEM_DETAIL:b("#library-search-container").hide(),b("#"+o().contentIDs.searchcatalog).hide(),b("#"+o().contentIDs.availability).show(),b("#"+n().contentIDs.pickuplocation).hide(),b("#"+o().contentIDs.advancedSearch).hide(),b("#"+o().contentIDs.whatsNew).hide(),w(o().contentIDs.availability,!1);break;case u().PICKUP_LOCATION:b("#library-search-container").hide(),b("#"+o().contentIDs.searchcatalog).hide(),b("#"+o().contentIDs.availability).hide(),b("#"+o().contentIDs.advancedSearch).hide(),b("#"+n().contentIDs.pickuplocation).show(),b("#"+o().contentIDs.whatsNew).hide(),b("#"+p().contentIDs.account).hide(),b("#"+p().contentIDs.location).hide(),b("#"+p().contentIDs.suspend).hide(),w(n().contentIDs.pickuplocation,!1);break;case u().LOGIN:b("#library-search-container").hide(),b("#"+o().contentIDs.searchcatalog).hide(),b("#"+o().contentIDs.availability).hide(),b("#"+o().contentIDs.pickuplocation).hide(),b("#"+o().contentIDs.advancedSearch).hide(),b("#"+n().contentIDs.yourstatus).hide(),b("#"+o().contentIDs.whatsNew).hide(),w(q().contentIDs.login,!1);break;case u().FORGOTTEN_PASSWORD:b("#library-search-container").hide(),b("#"+o().contentIDs.searchcatalog).hide(),b("#"+o().contentIDs.availability).hide(),b("#"+o().contentIDs.pickuplocation).hide(),b("#"+o().contentIDs.advancedSearch).hide(),b("#"+n().contentIDs.yourstatus).hide(),b("#"+o().contentIDs.whatsNew).hide(),b("#"+q().contentIDs.forms.login).hide(),b("#"+q().contentIDs.forms.resetpin).hide(),b("#"+q().contentIDs.forms.resetpinconfirm).show(),w(q().contentIDs.forms.resetpinconfirm,!1);break;case u().ADV_SEARCH:o().reset(),o().clearResults(),o().clearSearchInputBox(),b("#library-search-container").hide(),b("#"+o().contentIDs.searchcatalog).hide(),b("#"+o().contentIDs.availability).hide(),b("#"+o().contentIDs.pickuplocation).hide(),b("#"+o().contentIDs.advancedSearch).show(),w(o().contentIDs.advancedSearch,!1);break;case u().ACCOUNT:b("#"+p().contentIDs.account).show(),b("#"+p().contentIDs.location).hide(),b("#"+p().contentIDs.suspend).hide(),b("#"+o().contentIDs.whatsNew).hide(),b("#"+n().contentIDs.pickuplocation).hide(),b("#"+n().contentIDs.yourstatus).show(),w(p().contentIDs.account,!1);break;default:}};a.init=function(a){g("call common library services init "),t(),f=a},a.trace=function(a){return g(a)},a.getQueryString=function(a,b){return j(a,b)},a.returnListObjects=function(a){return m(a)},a.getLibraryName=function(a,b){return h(d,a,b)},a.catalogTemplate=function(){return o()},a.accountTemplate=function(){return p()},a.loginTemplate=function(){return q()},a.overlayTemplate=function(){return r()},a.sharedTemplate=function(){return n()},a.showHide=function(a){x(a)},a.show=function(){b("#library-loading-indicator").show()},a.hide=function(){s()},a.overlay=function(a,c){r().populateOverlay(c);var d="width:{0}%; height:250px;border:solid {1}px purple;";d=d.replace("{0}",a).replace("{1}",a>0?2:0),s(),b("#library-message").attr("style",d)},a.searchView=function(){return u()},a.getTimeout=function(){return e},a.hidesearchbar=function(){b("#search").attr("style","display:none;"),b("#toggle-search").attr("style","display:none;")},a.setcontentview=function(a){v(a)},a.getcontentview=function(){var a=window.cookieservices.ReadCookie("contentview");return parseInt(a!==null?a:-1)},a.setCookie=function(a,b){a?v(b):v(-1)},a.scrollTo=function(a,b){w(a,b)},a.predicateBy=function(a){return i(a)}}(window.commonlibraryservices=window.commonlibraryservices||{},jQuery)
;"use strict",function(a,b,c){var d="",e="",f="",g=200,h=null,i=null,j=null,k=null,l=null,m,n=null,o=function(){b.ajax({type:"GET",url:window.commonservices.Config().libraryUrl+"/security/libraryUrls"}).then(function(a){l=a}).fail(function(a){})},p=function(c,d){k=d;var e=function(c){var d=null,e=function(c){var d={},e={username:"",pswd:""};b.each(b("#loginlibrary-form").serializeArray(),function(a,b){d[b.name]=b.value}),e.username=d.loginUsername,e.pswd=d.loginPassword,d=null,a.login(e.username,e.pswd,c)},f=function(a){d!==null&&b("#loginlibrary-form").data("bootstrapValidator",null),d=b("#loginlibrary-form").bootstrapValidator({feedbackIcons:{valid:"glyphicon glyphicon-ok",invalid:"glyphicon glyphicon-remove",validating:"glyphicon glyphicon-refresh"},fields:{loginUsername:{validators:{notEmpty:{message:"The library card number needs to be entered."}}},loginPassword:{validators:{notEmpty:{message:"The password pin needs to be entered."}}}},submitHandler:function(b,c,d){e(a)},destroy:function(){}})};f(c)},f=function(c){b("#library-login-btn").on("click",function(d){d.preventDefault(),a.login(b("#loginUsername").val(),b("#loginPassword").val(),c)})},g=function(){var a=function(){var a=null,c=function(){var a={},c={userId:""};b.each(b("#reset-pin-form").serializeArray(),function(b,c){a[c.name]=c.value}),c.userId=a.userId,a=null,r(c.userId,function(a){a?commonlibraryservices.overlay(100,"An email has been sent to reset your password."):commonlibraryservices.overlay(100,"Unable to reset your password pin.<br/>"),commonlibraryservices.hide()})},d=function(){var d={isNotEmpty:function(a){var b=/\S+/;return b.test(a)},isNumber:function(a){var b=/^\d+$/;return b.test(a)}};a!==null&&b("#reset-pin-form").data("bootstrapValidator",null),a=b("#reset-pin-form").bootstrapValidator({feedbackIcons:{valid:"glyphicon glyphicon-ok",invalid:"glyphicon glyphicon-remove",validating:"glyphicon glyphicon-refresh"},fields:{userId:{validators:{notEmpty:{message:"The library barcode user Id needs to be entered."},callback:{callback:function(a,b,c){var e=d.isNumber(a);return e?a.length<14?{valid:!1,message:"The library bar code user Id must be at least 14 characters long."}:!0:{valid:!1,message:"The library barcode user Id must contains all digits only."}}}}}},submitHandler:function(a,b,d){c()},destroy:function(){}})};d()};b("#reset-pin").bind("click",function(b){commonlibraryservices.loginTemplate().hideLogin(),commonlibraryservices.loginTemplate().showResetPin(),a(),b.preventDefault()})},h=function(){var a=function(){var a=null,c=function(){var a={},c={password:""};b.each(b("#reset-confirm-form").serializeArray(),function(b,c){a[c.name]=c.value}),c.password=a.newPassword,a=null,accountlibraryservices.ChangePin("",c.password,m,function(a,b){a?commonlibraryservices.overlay(100,"Your password pin have been updated."):commonlibraryservices.overlay(100,"Unable to change your password pin.<br/>"),commonlibraryservices.hide()})},d=function(){var d={isNotEmpty:function(a){var b=/\S+/;return b.test(a)},isNumber:function(a){var b=/^\d+$/;return b.test(a)},isSame:function(a,b){return a===b}};a!==null&&b("#reset-confirm-form").data("bootstrapValidator",null),a=b("#reset-confirm-form").bootstrapValidator({feedbackIcons:{valid:"glyphicon glyphicon-ok",invalid:"glyphicon glyphicon-remove",validating:"glyphicon glyphicon-refresh"},fields:{newPassword:{validators:{notEmpty:{message:"The new password needs to be entered."},callback:{callback:function(a,b,c){var e=d.isNumber(a);return a.length!==4?{valid:!1,message:"The pin must be only 4 characters long."}:e?!0:{valid:!1,message:"The new pin must contains digits only."}}}}},confirmPassword:{validators:{notEmpty:{message:"The confirm pin needs to be entered."},identical:{field:"newPassword",message:"The new pin and its confirm pin are not the same"}}}},submitHandler:function(a,b,d){c()},destroy:function(){}})};d()};a()};i.populateLogin(l),e(c),g(),n=commonlibraryservices.getQueryString("resettoken"),n!=null?s(n,function(a){a?(commonlibraryservices.showHide(commonlibraryservices.searchView().FORGOTTEN_PASSWORD),h()):commonlibraryservices.overlay(100,"Sorry this is not a valid token or it has now expired.<br/> Please use the forgotten password link to issue a new token."),commonlibraryservices.hide()}):commonlibraryservices.hide()},q=function(a,c,j){var m=function(){b.post(window.commonservices.Config().libraryUrl+"/security/login",{Username:a,Password:c,Token:""}).then(function(a){return a===null?j(!1,k):(d=a.sessionTokenField,e=a.userIDField,f=e,window.cookieservices.CreateCookie("libraryToken",d,.05),window.cookieservices.CreateCookie("libraryUserId",e,.05),window.cookieservices.EraseCookie("contentview"),window.cookieservices.CreateCookie("contentview","",.05),v(e,d),j!=null?j(!0,k):!0)}).fail(function(a){return h.trace("Promise Error:securitylibraryservices"),h.trace(a),i.populateLoginLink(null,l),j(!1,k)})};h.show(),setTimeout(function(){m()},g)},r=function(a,c){var d=function(){b.post(window.commonservices.Config().libraryUrl+"/security/resetpin",{Username:a,Password:"",Token:""}).then(function(a){c(!0)}).fail(function(a){c(!1)})};h.show(),setTimeout(function(){d()},g)},s=function(a,c){b.ajax({url:window.commonservices.Config().libraryUrl+"/security/validresettoken/"+a,type:"GET"}).then(function(a){m=a.sessionTokenField,c(!0)}).fail(function(a){c(!1)})},t=function(a){var c=function(){d=window.cookieservices.ReadCookie("libraryToken"),e=window.cookieservices.ReadCookie("libraryUserId"),d===null&&(e=d="uknown"),b.ajax({url:window.commonservices.Config().libraryUrl+"/security/authenticated/"+e+"/"+d}).done(function(b){return b==="OK"?a(!0):(i.populateLoginLink(null,l),a(!1))}).fail(function(b){return h.trace("Promise Error: securitylibraryservices"),i.populateLoginLink(null,l),a(!1)})};setTimeout(function(){c()},g)},u=function(a){b.get(window.commonservices.Config().libraryUrl+"/security/logout/"+d,function(b,c){d="",e="",i.populateLoginLink(null,l),j.clearYourStatus(),a(!0)}).fail(function(){d="",e="",i.populateLoginLink(null,l),a(!1)}),cookieservices.EraseCookie("libraryToken"),cookieservices.EraseCookie("libraryUserId"),cookieservices.EraseCookie("contentview")},v=function(a,c){var d=window.commonservices.Config().libraryUrl+"/patron/patroninfo/{0}/{1}";d=d.replace("{0}",a),d=d.replace("{1}",c),b.ajax({url:d,type:"GET"}).then(function(a){a=JSON.parse(a),a!=null&&(f=a.patronInfo.displayName,i.populateLoginLink(f,l),w(c))}).fail(function(a){})},w=function(a){var c=window.commonservices.Config().libraryUrl+"/patron/statusSummary/{0}";c=c.replace("{0}",a),b.ajax({url:c,type:"GET"}).then(function(a){a!=null?j.populateYourStatus(a):j.clearYourStatus()}).fail(function(a){j.clearYourStatus()})};a.init=function(a){h=a,i=h.loginTemplate(),j=h.sharedTemplate(),h.trace("call security library services init "),o()},a.login=function(a,b,c){return q(a,b,c)},a.resetpin=function(a,b){return r(a,b)},a.logout=function(a){u(a)},a.authenticated=function(a){return t(a)},a.patronInfo=function(){v(e,d)},a.yourStatus=function(a){a?w(d):j.clearYourStatus()},a.clearloginTemplate=function(){return i.clearLogin()},a.goToLoginPage=function(a,b){return p(a,b)},a.librarycodeInformation=function(){commonlibraryservices.overlay(100,"Your library number can be found on the back of your library card.")}}(window.securitylibraryservices=window.securitylibraryservices||{},jQuery)
;(function(a,b,c){pager={page:1,records:0,total:0,firstHitToDisplay:0,lastHitToDisplay:0,queryId:""};var d="",e=200,f=null,g=null,h=null,i=null,j=null,k={Term1:"",Term2:"",SearchType:"",HitsToDisplay:5,LibraryFilter:"",PublishYearFilter:null,LanguageFilter:"",ItemTypeFilter:"",ExactMatch:!1,Token:d},l={current:0,total:0,pageSize:0,pageBoundary:{first:1,last:1},pageRange:{start:0,end:0}},m=function(a,c,d){l.current=a,l.total=d,l.pageSize=c,l.pageBoundary.last=d,l.pageRange.start=a,l.pageRange.end=a+(l.pageSize-1);if(l.pageRange.end>=l.pageBoundary.last){var e=l.pageRange.end-l.pageBoundary.last;l.pageRange.end=l.pageRange.end-e,l.pageRange.start=l.pageRange.start-e}var f=function(a){var c=1;b("ul#"+a+" a.center-links").each(function(){c<l.pageRange.start||c>l.pageRange.end?b(this).hide():l.pageBoundary.last>5?b(this).css("display",""):b(this).show(),c++})},g=function(a,c){c?b(a).show():b(a).hide()},h=function(a){g("li.dots-right",a),b("a.right-link").each(function(){a?b(this).css("display",""):b(this).hide()})},i=function(a){g("li.dots-left",a),b("a.left-link").each(function(){a?b(this).css("display",""):b(this).hide()})};l.pageRange.end<l.pageBoundary.last?h(!0):h(!1),l.pageRange.start>l.pageBoundary.first?i(!0):i(!1),f("top_library_pager"),f("bottom_library_pager")},n=function(){var a=function(a,b,c,d){if(b>0&&c>0&&b>c){var e=b%c,f=(b-e)/c+1;e==0&&f--,pager.page=a,pager.firstHitToDisplay=(pager.page-1)*c+1,pager.lastHitToDisplay=d?pageItem.FirstHitToDisplay+e-1:pager.page*c}},c=function(a,c,d){var e=a+"/"+c+"/"+d;b.ajax({url:window.commonservices.Config().libraryUrl+"/standard/catalogsearchpages/"+e}).then(function(a){var b={};b.data=a,b.pages=b.data.totalHitsField>0?a.GetAllPages:null;if(b.pages!==null){var c=new Array;for(var d=0;d<b.data.hitlistTitleInfoField.length;d++)c.push({HoldKey:0,TitleKey:b.data.hitlistTitleInfoField[d].titleIDField,Location:"",Token:"",UserID:""});o(c,function(a,b){b&&(g.populateResults(a),i(b,a),f.hide())})}}).fail(function(a){f.trace("Promise Error: cataloglibraryservices"),f.trace(a),commonlibraryservices.hide()})};b("a.page-link").on("click",function(a){a.stopPropagation(),a.preventDefault();var d=this.id.split("-");pager.page=parseInt(d[1]),pager.firstHitToDisplay=parseInt(d[2]),pager.lastHitToDisplay=parseInt(d[3]),g.clearResults(),g.clearAvailabilty(),f.show();var h=function(){c(pager.queryId,pager.firstHitToDisplay,pager.lastHitToDisplay),m(pager.page,k.HitsToDisplay,pager.total),b("ul.pagination > li > a.page-link").removeClass("active");var a="pager-{0}-{1}-{2}";a=a.replace("{0}",pager.page),a=a.replace("{1}",pager.firstHitToDisplay),a=a.replace("{2}",pager.lastHitToDisplay),b("#top_"+a).addClass("active"),b("#bottom_"+a).addClass("active")};setTimeout(function(){h()},e)}),b("a.library-pager-prev").on("click",function(d){d.stopPropagation(),d.preventDefault(),g.clearResults(),g.clearAvailabilty(),f.show();var e=function(){pager.page=pager.page>1?pager.page-1:1,a(pager.page,pager.records,k.HitsToDisplay,!1),c(pager.queryId,pager.firstHitToDisplay,pager.lastHitToDisplay),m(pager.page,k.HitsToDisplay,pager.total),b("ul.pagination > li > a.page-link").removeClass("active");var d="pager-{0}-{1}-{2}";d=d.replace("{0}",pager.page),d=d.replace("{1}",pager.firstHitToDisplay),d=d.replace("{2}",pager.lastHitToDisplay),b("#top_"+d).addClass("active"),b("#bottom_"+d).addClass("active")};setTimeout(function(){e()},2e3)}),b("a.library-pager-next").on("click",function(d){d.stopPropagation(),d.preventDefault(),g.clearResults(),g.clearAvailabilty(),f.show();var h=function(){pager.page=pager.page<pager.total?pager.page+1:pager.total,a(pager.page,pager.records,k.HitsToDisplay,pager.page===pager.total),c(pager.queryId,pager.firstHitToDisplay,pager.lastHitToDisplay),m(pager.page,k.HitsToDisplay,pager.total),b("ul.pagination > li > a.page-link").removeClass("active");var d="pager-{0}-{1}-{2}";d=d.replace("{0}",pager.page),d=d.replace("{1}",pager.firstHitToDisplay),d=d.replace("{2}",pager.lastHitToDisplay),b("#top_"+d).addClass("active"),b("#bottom_"+d).addClass("active")};setTimeout(function(){h()},e)})},o=function(a,c){b.ajax({type:"POST",url:window.commonservices.Config().libraryUrl+"/standard/lookupTitleInformationList",data:{"":a}}).then(function(a){return c(a,!0)}).fail(function(a){return c(null,!1)})},p=function(a,c){var d=function(){var d={};b.ajax({url:window.commonservices.Config().libraryUrl+"/standard/lookupTitleInformation/"+a}).then(function(a){return b("#"+g.contentIDs.searchcatalog).hide(),d.TitleInfo=a,g.populateAvailability(d),f.showHide(f.searchView().ITEM_DETAIL),f.hide(),c(!0)}).fail(function(a){return f.trace("Promise Error: cataloglibraryservices"),f.trace(a),c(!1)})};setTimeout(function(){d()},e)},q=function(a,c){var d={};g.reset(),h.clearPickupLocation(),f.show();var i=function(){b.ajax({url:window.commonservices.Config().libraryUrl+"/standard/catalogsearchrest/",data:{Term1:k.Term1,Term2:k.Term2,SearchType:k.SearchType,HitsToDisplay:k.HitsToDisplay,LibraryFilter:k.LibraryFilter,LanguageFilter:k.LanguageFilter,ItemTypeFilter:k.ItemTypeFilter,ExactMatch:k.ExactMatch,showAvailableOnly:k.showAvailableOnly,IsAdvancedSearch:k.IsAdvancedSearch,Token:k.Token}}).then(function(a){commonlibraryservices.trace("First Response:");if(a!==null&&a.hitlistTitleInfoField!==null)return d.data=a,pager.queryId=a.queryIDField,b.ajax({url:window.commonservices.Config().libraryUrl+"/standard/pager/"+a.totalHitsField+"/"+k.HitsToDisplay});d.data=a,pager.queryId=""}).then(function(a){commonlibraryservices.trace("second Response:"),d.pages=d.data.totalHitsField>0?a.GetAllPages:null;if(d.pages!==null){var b=new Array;for(var e=0;e<d.data.hitlistTitleInfoField.length;e++)b.push({HoldKey:0,TitleKey:d.data.hitlistTitleInfoField[e].titleIDField,Location:"",Token:"",UserID:""});o(b,function(a,b){b&&(g.populateResults(a),g.populatePagination(d.pages,d.data.totalHitsField),d.pages!==null&&(n(),pager.total=d.pages.length,pager.records=d.data.totalHitsField,m(1,k.HitsToDisplay,pager.total),g.clearAdvancedSearch(),g.showSearchInput(),c(!0,a)),commonlibraryservices.hide())})}else commonlibraryservices.hide(),g.populateResults(null),c(!1,null)}).fail(function(a){commonlibraryservices.trace("Promise Error: cataloglibraryservices"),commonlibraryservices.trace(a)})};setTimeout(function(){i()},e)},r=function(a){b.ajax({url:window.commonservices.Config().libraryUrl+"/standard/cataloghotlist/",method:"GET"}).then(function(c){return c!==null?(j=c.hitlistTitleInfoField,b.ajax({url:window.commonservices.Config().libraryUrl+"/standard/lookupTitleInformation/"+j[0].titleIDField})):a(!1,null,null)}).then(function(b){return a(!0,j,b)}).fail(function(b){return a(!1,null,null)})},s=function(a,c){var d={};f.show();var g=function(){b.ajax({url:window.commonservices.Config().libraryUrl+"/standard/catalogsearchrest/",data:{Term1:k.Term1,Term2:k.Term2,SearchType:k.SearchType,HitsToDisplay:1,LibraryFilter:null,LanguageFilter:null,ItemTypeFilter:null,ExactMatch:k.ExactMatch,showAvailableOnly:null,IsAdvancedSearch:!1,Token:null}}).then(function(a){if(a!==null&&a.totalHitsField===1){var b=new Array;b.push({HoldKey:0,TitleKey:a.hitlistTitleInfoField[0].titleIDField,Location:"",Token:"",UserID:""}),o(b,function(a,b){b&&c(a,!0)})}else c(null,!1)}).fail(function(a){c(null,!1)})};setTimeout(function(){g()},e)};a.init=function(a,b){f=a,g=f.catalogTemplate(),h=f.sharedTemplate(),i=b,e=f.getTimeout(),f.trace("call catalog library services init ")},a.searchCriteria=function(){return k},a.catalogsearch=function(a,b){q(a,b)},a.catalogSearchByISBN=function(a,b){s(a,b)},a.catalogitem=function(a,b){p(a,b)},a.catalogItemsList=function(a,b){o(a,b)},a.hotList=function(a){r(a)},a.selectedHotList=function(a,c){b.ajax({url:window.commonservices.Config().libraryUrl+"/standard/lookupTitleInformation/"+a}).then(function(a){return c(!0,a)}).fail(function(a){return c(!1,data)})}})(window.cataloglibraryservices=window.cataloglibraryservices||{},jQuery)
;"use strict",function(a,b,c){var d={LOCATION:0,SUSPEND:1},e="",f="",g=200,h=null,i=null,j=null,k=null,l=null,m=null,n=null,o=null,p=null,q={mylist:null,account:null},r=function(a,b){var c=dateservices.convertStringDate(a,"yyyy-mm-dd","-"),d=dateservices.convertStringDate(b,"yyyy-mm-dd","-"),e=new Date;return e.setHours(0,0,0,0),c<=e&&d>=e},s=function(a,b){var c=dateservices.convertStringDate(a,"yyyy-mm-dd","-"),d=dateservices.convertStringDate(b,"yyyy-mm-dd","-"),e=new Date;return e.setHours(0,0,0,0),c<=e&&d>=e},t=function(a,c){var d={},f=null,j=null,l=new Array,n=function(){b.ajax({url:window.commonservices.Config().libraryUrl+"/patron/accountdetails/"+e}).then(function(a){d.data=a;if(d.data!==null&&d.data.patronCheckoutInfoField!==null){var b=d.data.patronCheckoutInfoField;for(var c=0;c<b.length;c++)l.push({HoldKey:0,TitleKey:b[c].titleKeyField,Location:"",Token:"",UserID:""})}}).then(function(a){if(d!==null)return b.ajax({url:window.commonservices.Config().libraryUrl+"/patron/getMyLists/"+e})}).then(function(a){f=h.returnListObjects(a);if(f!==null&&f.length>0)return p=j=f[0].myListIDField,b.ajax({url:window.commonservices.Config().libraryUrl+"/patron/getMyList/"+j+"/"+e})}).then(function(b){var e=!1,f=function(b,c){m.populateAccount(b,c),m.hideLocation(),m.hideSuspend(),m.showAccount(),h.hide(),k.init(),k.open(a),togglelibraryservices.init()},g=function(){if(j!==null){var a=h.returnListObjects(b);if(a!==null&&a.length>0){a=a[0];if(a!==null&&a.myListEntryInfoField!==null){var e=new Array;for(var g=0;g<a.myListEntryInfoField.length;g++)e.push({HoldKey:0,TitleKey:a.myListEntryInfoField[g].titleKeyField,Location:"",Token:"",UserID:""});i.catalogItemsList(e,function(a,b){b?(q.mylist=a,q.account=d,f(d,a),c(!0,q)):(f(d,null),c(!1,q))})}else f(d,null),c(!0,q)}}else q.mylist=null,q.account=d,c(!0,q)};i.catalogItemsList(l,function(a,b){b?(d.checkoutItems=a,g()):c(!1,q)})}).fail(function(){c(!1,q)})};h.show(),m.hideLocation(),setTimeout(function(){n()},g)},u=function(){b.get(window.commonservices.Config().libraryUrl+"/patron/getMyLists/"+e,function(a,c){var d=returnListObjects(a);b.each(d,function(a,b){v(b.myListIDField)})}).fail(function(){})},v=function(a){p=a,b.get(window.commonservices.Config().libraryUrl+"/patron/getMyList/"+a+"/"+e,function(a,b){var c=returnListObjects(a);if(c!==null&&c.length>0)return c}).fail(function(){})},w=function(a,c,d){b.ajax({url:window.commonservices.Config().libraryUrl+"/patron/getMyLists/"+e}).then(function(d){var f=null;d!==null&&d.length>0&&(f=d[0].myListIDField);var g=new Array;for(var h=0;h<a.length;h++)g.push({ListId:f,TitleId:a[h],Operation:c,Token:e});return b.ajax({type:"POST",url:window.commonservices.Config().libraryUrl+"/patron/saveMyList",data:{"":g}})}).then(function(a){switch(c){case"create":return d(!0);default:return d(!0)}}).fail(function(){switch(c){case"create":return d(!1);default:return d(!1)}})},x=function(a,c){b.ajax({url:window.commonservices.Config().libraryUrl+"/patron/deleteMyList",type:"POST",contentType:"application/json",data:jSON.stringify({ListId:a,UserID:"",Token:e}),success:function(a){c(!0)},error:function(a){c(!1)}})},y=function(a,c,f){var i=function(){b("button#back-to-account").on("click",function(a){a.stopPropagation(),a.preventDefault(),h.show(),setTimeout(function(){m.hideSuspend(),m.hideLocation(),m.showAccount(),h.hide()},g)})},j=new Array;for(var k=0;k<a.length;k++)j.push({HoldKey:a[k],TitleKey:0,Location:"",Token:e,UserID:""});return b.ajax({type:"POST",url:window.commonservices.Config().libraryUrl+"/patron/getholditems",data:{"":j},success:function(a){m.hideAccount(),c===d.LOCATION?(m.populateLocation(a),m.showLocation()):(m.populateSuspend(a),m.showSuspend()),h.hide(),i(),f(!0)},error:function(a){f(!1)}})},z=function(a,c){b.get(window.commonservices.Config().libraryUrl+"/patron/getholditem/"+a+"/"+e,function(a,b){c(!0)}).fail(function(){c(!1)})},A=function(a,c,d){b.post(window.commonservices.Config().libraryUrl+"/patron/holditem",{Titlekey:a,HoldKey:0,Location:c,Token:e},function(a,b){d(!0)}).fail(function(a){d(!1,a.responseJSON)})},B=function(a,c){var d=new Array;for(var f=0;f<a.length;f++)d.push({HoldKey:0,TitleKey:a[f].titleId,Location:a[f].libraryId,Token:e,UserID:""});b.post(window.commonservices.Config().libraryUrl+"/patron/holditems",{"":d},function(a,b){c(!0)}).fail(function(a){c(!1,a.responseJSON)})},C=function(a,c){var d=new Array;for(var f=0;f<a.length;f++)d.push({HoldKey:a[f],TitleKey:0,Location:0,Token:e});b.ajax({type:"POST",url:window.commonservices.Config().libraryUrl+"/patron/cancelholditems",data:{"":d},success:function(a){c(!0)},error:function(a){c(!1)}})},D=function(a,c,d,f){var g=new Array;for(var h=0;h<a.length;h++)g.push({HoldKey:a[h],TitleKey:0,Location:0,StartDate:c.toUTCString(),EndDate:d.toUTCString(),Token:e});b.ajax({type:"POST",url:window.commonservices.Config().libraryUrl+"/patron/suspendholditems",data:{"":g},success:function(a){f(!0,"")},error:function(a){f(!1,a.responseText)}})},E=function(a,c){var d=new Array;for(var f=0;f<a.length;f++)d.push({HoldKey:a[f],TitleKey:0,Location:0,Token:e});b.ajax({type:"POST",url:window.commonservices.Config().libraryUrl+"/patron/cancelSuspendHolditem",data:{"":d},success:function(a){c(!0)},error:function(a){c(!1)}})},F=function(a,c){var d=new Array;for(var f=0;f<a.length;f++)d.push({HoldKey:a[f].Id,TitleKey:0,Location:a[f].locationId,Token:e,UserID:""});b.ajax({type:"POST",url:window.commonservices.Config().libraryUrl+"/patron/editLocationHolditems",data:{"":d},success:function(a){c(!0)},error:function(a){c(!1)}})},G=function(a,c,d,f){d===null&&(d=e),b.post(window.commonservices.Config().libraryUrl+"/patron/changePin",{CurrentPin:a,NewPin:c,Token:d},function(a,b){return a?f(!0):f(!1)}).fail(function(a){f(!1,a.responseJSON.ExceptionMessage)})},H=function(a,c){b.post(window.commonservices.Config().libraryUrl+"/patron/renewItem",{Titlekey:a,HoldKey:0,Location:0,Token:e,UserID:f},function(a,b){if(a)return c(!0,"");c(!1,"A problem occurred with this item renewal")}).fail(function(a){c(!1,a.responseJSON.ExceptionMessage)})},I=function(a,c){b.post(window.commonservices.Config().libraryUrl+"/patron/emailMyList",{Email:a,ListId:p,Token:e},function(a,b){return a?c(!0):c(!1)}).fail(function(a){c(!1,a.responseJSON.ExceptionMessage)})},J=function(){e=window.cookieservices.ReadCookie("libraryToken"),f=window.cookieservices.ReadCookie("libraryUserId")};a.init=function(a,b,c,d,e){h=a,j=c,i=b,l=d,m=h.accountTemplate(),n=h.sharedTemplate(),k=e},a.accountInfo=function(a,b){J(),t(a,b)},a.reset=function(){m.clearAccount(),n.reset()},a.savemylist=function(a,b,c){J(),w(a,b,c)},a.getmylists=function(){J(),u()},a.getmyList=function(a){return J(),v(a)},a.deletemyList=function(a,b){return J(),w(a,"delete",b)},a.getHoldItem=function(a,b){J(),z(a,b)},a.getHoldItems=function(a,b){J(),y(a,d.LOCATION,b)},a.createhold=function(a,b,c){J(),A(a,b,c)},a.createholds=function(a,b){J(),B(a,b)},a.cancelhold=function(a,b){C(a,b)},a.getSuspendItems=function(a,b){J(),y(a,d.SUSPEND,b)},a.suspendHold=function(a,b,c,d){J(),D(a,b,c,d)},a.unsuspendHold=function(a,b){J(),E(a,b)},a.editLocationHold=function(a,b){J(),F(a,b)},a.ChangePin=function(a,b,c,d){J(),G(a,b,c,d)},a.renewItem=function(a,b){h.hide(),J(),H(a,b)},a.emailMyList=function(a,b){I(a,b)}}(window.accountlibraryservices=window.accountlibraryservices||{},jQuery)
;(function(a,b,c){var d="",e=200,f=null,g=null,h=null,i=null,j=function(a,c){b.ajax({type:"POST",url:window.commonservices.Config().libraryUrl+"/standard/lookupTitleInformationList",data:{"":a}}).then(function(a){return c(a,!0)}).fail(function(a){return c(null,!1)})},k=function(a,c,d){var g=new Array;for(var j=0;j<a.length;j++)g.push({HoldKey:0,TitleKey:a[j],Location:"",Token:"",UserID:""});var k=function(a,c){h.catalogItemsList(g,function(d,e){var g={};g.data=d,g.viewmode={title:"Choose a pick up location",page:a},e?(b("#"+f.catalogTemplate().contentIDs.searchcatalog).hide(),i.populatePickupLocation(g),f.hide(),c(!0)):(f.trace("Promise Error: cataloglibraryservices"),f.trace(err),f.hide(),c(!1))})};setTimeout(function(){k(c,d)},e)};a.init=function(a,b,c){f=a,g=b,h=c,i=f.sharedTemplate(),e=f.getTimeout(),f.trace("call shared library services init ")},a.populatePickupLocation=function(a,b,c){k(a,b,c)},a.clearPickupLocation=function(){templates.clearPickupLocation()}})(window.sharedlibraryservices=window.sharedlibraryservices||{},jQuery)
;"use strict",function(a,b,c){function m(a){if(a.length>9){var b=a.split("-");return b[2]+"-"+b[1]+"-"+b[0]}return a}var d=null,e=null,f=null,g=null,h=null,i=null,j=null,k=null,l={success:"",error:"",visible:!0},n=function(a){a?(securitylibraryservices.clearloginTemplate(),accountlibraryservices.accountInfo(-1,p)):g.overlay(100,"Unable to log you in. Please check your username and password.")},o=function(a,b){var c=function(b){g.accountTemplate().clearAccount(),g.accountTemplate().populateAccount(b.account,b.mylist),g.accountTemplate().hideLocation(),g.accountTemplate().hideSuspend(),g.accountTemplate().showAccount(),g.hide(),i.init(),i.open(a),j.init()};c(b),p(a,b),g.showHide(g.searchView().ACCOUNT)},p=function(a,c){f=c;var d=function(){var a=null,d=null,e=function(){var a="select.onloan-orderby",d=0;b(a).on("change",function(){d=this.selectedIndex;switch(this.value){case"Title":f.account.checkoutItems.sort(g.predicateBy("titleField")),o(2,c),d=this.selectedIndex;break;case"Author":f.account.checkoutItems.sort(g.predicateBy("authorField")),o(2,f),d=this.selectedIndex;break;case"Publish":f.account.checkoutItems.sort(g.predicateBy("datePublishedField")),o(2,f),d=this.selectedIndex;break;default:}b(a).prop("selectedIndex",d)})},h=function(){b(".renew-click").on("click",function(b){a=null,a=this.id.split("-")[1],i()})},i=function(){d=b("#renew-hidden-"+a).val(),g.show(),accountlibraryservices.renewItem(d,function(a,b){a?(g.overlay(100,"Item has been renewed."),accountlibraryservices.accountInfo(2,p)):g.overlay(100,"Unable to renew items. <br/>"+b)})};h(),e()},e=function(){var a=null,c=function(){var a=b("table.patron-hold-info input:checked").map(function(){return this.value}).get();return a.length>0?a:null},d=function(){b("#patron-hold-info-all").change(function(){b("table.patron-hold-info input[type='checkbox']").prop("checked",b(this).prop("checked"))})},e=function(){var e=function(b){b?(g.show(),accountlibraryservices.getHoldItems(a,function(a){a&&h()})):accountlibraryservices.reset()},f=function(){b("#onhold-edit").on("click",function(b){a=c(),b.preventDefault(),a===null?g.overlay(100,"You need to tick your checkboxes from on hold items."):securitylibraryservices.authenticated(e)})},h=function(){b("#update-location").on("click",function(c){var d=function(){var a=new Array;return b("select.select-edit-location option:selected").each(function(){a.push(this.value)}),a.length>0?a:null},e=d(),f=new Array;for(var h=0;h<a.length;h++)f.push({Id:a[h],locationId:e[h]});accountlibraryservices.editLocationHold(f,function(a){a?(g.overlay(100,"Your library pickup locations updated."),accountlibraryservices.accountInfo(3,p)):g.overlay(100,"Unable to update your library pickup locations.")})})};d(),f()},f=function(){var e=function(){var a=null,c=null,d={Id:null,StartDate:null,EndDate:""},e=function(){var a={};b.each(b("#suspenditem-form").serializeArray(),function(b,c){a[c.name]=c.value}),d.Id=parseInt(a.holdkeyId),d.StartDate=m(a.StartDateTime),d.EndDate=m(a.EndDateTime),a=null,c=i(),d.StartDate=window.dateservices.convertToDate(d.StartDate,"dd-mm-yyyy","-"),d.EndDate=window.dateservices.convertToDate(d.EndDate,"dd-mm-yyyy","-"),accountlibraryservices.suspendHold(c,d.StartDate,d.EndDate,function(a,b){a?(g.overlay(100,"Items have been suspended."),accountlibraryservices.accountInfo(3,p)):g.overlay(100,"Unable to suspend items.<br/>"+b)})},f=function(){var a=function(a){b("#suspenditem-form").bootstrapValidator("updateStatus","StartDateTime","VALIDATED").bootstrapValidator("validateField","StartDateTime")},c=function(a){b("#suspenditem-form").bootstrapValidator("updateStatus","EndDateTime","VALIDATED").bootstrapValidator("validateField","EndDateTime")};b("#StartDateTime").focus(function(){a(b(this).val())}),b("#EndDateTime").focus(function(){c(b(this).val())}),b("#StartDateTime").blur(function(){a(b(this).val())}),b("#EndDateTime").blur(function(){c(b(this).val())});var d=function(){var a=new Date,b=a.getDate(),c=new String(a.getMonth()+1),d=a.getFullYear();b.length<2&&(b="0"+b),c.length<2&&(c="0"+c);var e=new String(d+"-"+c+"-"+b);return e}},h=function(){var c={isFutureDate:function(a){return dateservices.GreaterThanToday(m(a))},isSame:function(a,b){return a===b}};a!==null&&b("#suspenditem-form").data("bootstrapValidator",null),a=b("#suspenditem-form").bootstrapValidator({feedbackIcons:{valid:"glyphicon glyphicon-ok",invalid:"glyphicon glyphicon-remove",validating:"glyphicon glyphicon-refresh"},fields:{StartDateTime:{validators:{notEmpty:{message:"The date is required"},callback:{callback:function(a,b,d){var e=c.isFutureDate(a);return e?!0:{valid:!1,message:"The date must be greater than yesterdays date."}}}}},EndDateTime:{validators:{notEmpty:{message:"The date is required"},callback:{callback:function(a,b,d){var e=c.isFutureDate(a);return e?!0:{valid:!1,message:"The date must be greater than yesterdays date."}}}}}},submitHandler:function(a,b,c){e()},destroy:function(){console.log("destroy")}})},i=function(){var a=b("input.suspend-holdkeys").map(function(){return this.value}).get();return a.length>0?a:null};f(),h()},f=function(b){b?(g.show(),accountlibraryservices.getSuspendItems(a,function(a){a&&e()})):accountlibraryservices.reset()},h=function(){b("#onhold-suspend").on("click",function(b){a=c(),b.preventDefault(),a===null?g.overlay(100,"You need to tick your checkboxes from on hold items."):securitylibraryservices.authenticated(f)})};d(),h()},h=function(){var e=function(){b("#onhold-unsuspend").on("click",function(b){a=c(),b.preventDefault(),a===null?g.overlay(100,"You need to tick your checkboxes from on hold items."):securitylibraryservices.authenticated(f)})},f=function(b){if(!b)return notLoggedIn();accountlibraryservices.unsuspendHold(a,function(a){a&&(g.overlay(100,"Your items have been unsuspended."),accountlibraryservices.accountInfo(3,p))})};d(),e()},i=function(){var e=function(){b("#onhold-cancel").on("click",function(b){a=c(),b.preventDefault(),a===null?g.overlay(100,"You need to tick your checkboxes from on hold items."):securitylibraryservices.authenticated(f)})},f=function(b){if(!b)return accountlibraryservices.reset();accountlibraryservices.cancelhold(a,function(a){a?(g.overlay(100,"Your items have been cancelled."),accountlibraryservices.accountInfo(3,p),securitylibraryservices.yourStatus(!0),g.showHide(g.searchView().ACCOUNT)):g.overlay(100,"There was a problem cancelling your items")})};d(),e()};e(),f(),h(),i()},i=function(){var a=null,c=function(){var a="select.mylist-orderby",c=0;b(a).on("change",function(){c=this.selectedIndex;switch(this.value){case"Title":f.mylist.sort(g.predicateBy("titleField")),o(4,f),c=this.selectedIndex;break;case"Author":f.mylist.sort(g.predicateBy("authorField")),o(4,f),c=this.selectedIndex;break;case"Publish":f.mylist.sort(g.predicateBy("datePublishedField")),o(4,f),c=this.selectedIndex;break;default:}b(a).prop("selectedIndex",c)})},d=function(){var a=b("div.mylist-checkboxes input:checked").map(function(){return this.value}).get();return a.length>0?a:null},e=function(){b("#mylist-all").change(function(){b(".mylist-checkboxes input[type='checkbox']").prop("checked",b(this).prop("checked"))})},i=function(b){if(b){g.show();var c=g.searchView().ACCOUNT;sharedlibraryservices.populatePickupLocation(a,c,function(d){d&&(g.showHide(g.searchView().PICKUP_LOCATION),h.init(g),h.bindEvents(a,c,!0,function(a){a&&(l.visible=!1,j(b))}))})}else accountlibraryservices.reset()},j=function(b){b?(g.show(),accountlibraryservices.deletemyList(a,k)):accountlibraryservices.reset()},k=function(a){a?(accountlibraryservices.accountInfo(4,p),securitylibraryservices.yourStatus(!0),g.showHide(g.searchView().ACCOUNT),l.visible&&g.overlay(100,l.success)):l.visible&&g.overlay(100,l.error)},m=function(){b("#mylist-delete").on("click",function(b){l.success="Items removed from My List.",l.error="There was a problem removing items from My List.",l.visible=!0,a=d(),a===null?g.overlay(100,"To delete from My Lists. You need to tick your checkboxes from My Lists."):securitylibraryservices.authenticated(j)}),b("#mylist-reserve-item").on("click",function(b){l.success="",l.error="",l.visible=!1,a=d(),a===null?g.overlay(100,"To add to Hold from My Lists. You need to tick your checkboxes from My Lists."):securitylibraryservices.authenticated(i)}),b("#mylist-email").on("click",function(a){var c=function(){b("#mylist-email-cancel").on("click",function(a){g.show(),setTimeout(function(){b("#email-mylist-form").bootstrapValidator("resetForm",!0),b("#"+g.accountTemplate().contentIDs.mylist.email).hide(),b("#"+g.accountTemplate().contentIDs.mylist.main).show(),commonlibraryservices.hide()},400)})};g.show(),setTimeout(function(){b("#"+g.accountTemplate().contentIDs.mylist.main).hide(),b("#"+g.accountTemplate().contentIDs.mylist.email).show(),g.hide(),c()},400)})};e(),m(),c()},j=function(){var a=function(){var a=null,c=function(){var a={},c={pswd:"",newpswd:"",confirmpswd:""};b.each(b("#changepin-form").serializeArray(),function(b,c){a[c.name]=c.value}),c.pswd=a.currentPassword,c.newpswd=a.newPassword,c.confirmpswd=a.confirmPassword,a=null,accountlibraryservices.ChangePin(c.pswd,c.newpswd,null,function(a,b){a?(g.overlay(100,"Your pin have been updated."),accountlibraryservices.accountInfo(0,p)):g.overlay(100,"Unable to update your password.<br/>"+b)})},d=function(){var d={isEmailAddress:function(a){var b=/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/;return b.test(a)},isNotEmpty:function(a){var b=/\S+/;return b.test(a)},isNumber:function(a){var b=/^\d+$/;return b.test(a)},isSame:function(a,b){return a===b}};a!==null&&b("#changepin-form").data("bootstrapValidator",null),a=b("#changepin-form").bootstrapValidator({feedbackIcons:{valid:"glyphicon glyphicon-ok",invalid:"glyphicon glyphicon-remove",validating:"glyphicon glyphicon-refresh"},fields:{currentPassword:{validators:{notEmpty:{message:"The current password needs to be entered."}}},newPassword:{validators:{notEmpty:{message:"The new password needs to be entered."},callback:{callback:function(a,b,c){var e=d.isNumber(a);return console.log("digicount"),a.length!==4?{valid:!1,message:"The pin must be at only 4 characters long."}:e?!0:{valid:!1,message:"The new pin must contains all digits only."}}}}},confirmPassword:{validators:{notEmpty:{message:"The confirm pin needs to be entered."},identical:{field:"newPassword",message:"The new pin and its confirm pin are not the same"}}}},submitHandler:function(a,b,d){c()},destroy:function(){console.log("destroy")}})};d()};a()},k=function(){var a=function(){var a=null,c=function(){var c={isEmailAddress:function(a){var b=/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/;return b.test(a)},isNotEmpty:function(a){var b=/\S+/;return b.test(a)}};a!==null&&b("#email-mylist-form").data("bootstrapValidator",null),a=b("#email-mylist-form").bootstrapValidator({feedbackIcons:{valid:"glyphicon glyphicon-ok",invalid:"glyphicon glyphicon-remove",validating:"glyphicon glyphicon-refresh"},fields:{email:{validators:{notEmpty:{message:"An email address needs to be entered."},callback:{callback:function(a,b,d){var e=c.isEmailAddress(a);return e?!0:{valid:!1,message:"email address is not in valid format."}}}}}},submitHandler:function(a,b,c){e()},destroy:function(){}})},d=function(){b("#email-mylist-form").bootstrapValidator("resetForm",!0),b("#email").val("")},e=function(){var a={},c={email:""};b.each(b("#email-mylist-form").serializeArray(),function(b,c){a[c.name]=c.value}),c.email=a.email,a=null,g.show(),accountlibraryservices.emailMyList(c.email,function(a,e){a?(b("#"+g.accountTemplate().contentIDs.mylist.email).hide(),b("#"+g.accountTemplate().contentIDs.mylist.main).show(),d(),g.overlay(100,"My List has been sent to the following "+c.email+" address.")):g.overlay(100,"Unable to send the email at the moment.<br/>"),g.hide()})};c()};a()};d(),e(),i(),j(),k()},q=function(a){a?(securitylibraryservices.clearloginTemplate(),securitylibraryservices.patronInfo(),securitylibraryservices.yourStatus(!0),accountlibraryservices.accountInfo(-1,p)):(securitylibraryservices.goToLoginPage(n),securitylibraryservices.yourStatus(!1))};a.init=function(a,b,c,d){h=a,g=b,i=c,j=d},a.accountInfo=function(a){q(a)}}(window.accountcallbacks=window.accountcallbacks||{},jQuery)
;"use strict",function(a,b,c){var d=null,e=null,f=null,g=null,h=null,i=null,j={RESERVE:0,ADD_MYLIST:1,RESERVE_ALL:2,ADD_MYLIST_ALL:3},k={click:j,selectedclick:null,Ids:new Array},l=null,m=function(a,b){commonlibraryservices.setCookie(a,b)},n=function(a){var b=function(a){h.catalogTemplate().clearResults(),h.catalogTemplate().populateResults(a),h.hide()};b(a),w()},o=function(){var a=b("div.catalog-item input:checked").map(function(){return this.value}).get();return a.length>0?a:null},p=function(){b("#checkbox-all").change(function(){b("div.catalog-item input[type='checkbox']").prop("checked",b(this).prop("checked"))})},q=function(){b("div.catalog-item input[type='checkbox']").prop("checked",!1)},r=function(){b(".reserve-click").on("click",function(a){k.Ids=new Array,k.Ids.push(this.id.split("-")[1]),k.selectedclick=k.click.RESERVE,h.show(),g.clickData(k),g.searchView(h.searchView().SEARCH),securitylibraryservices.authenticated(g.reserveCallback)})},s=function(){b(".mylist-click").on("click",function(a){k.Ids=new Array,k.Ids.push(this.id.split("-")[1]),k.selectedclick=k.click.ADD_MYLIST,commonlibraryservices.show(),g.clickData(k),g.searchView(h.searchView().SEARCH),securitylibraryservices.authenticated(g.mylistCallback)})},t=function(){b(".reserve-all-click").on("click",function(a){k.Ids=o(),k.selectedclick=k.click.RESERVE_ALL,k.Ids===null?(commonlibraryservices.overlay(100,"You need to select your items by ticking the checkbox(s)."),m(!1,"")):(commonlibraryservices.show(),g.clickData(k),g.searchView(h.searchView().SEARCH),securitylibraryservices.authenticated(g.reserveCallback))})},u=function(){b(".mylist-all-click").on("click",function(a){k.Ids=o(),k.selectedclick=k.click.ADD_MYLIST_ALL,k.Ids===null?(commonlibraryservices.overlay(100,"You need to select your items by ticking the checkbox(s)."),m(!1,"")):(commonlibraryservices.show(),g.clickData(k),g.searchView(h.searchView().SEARCH),securitylibraryservices.authenticated(g.mylistCallback))})},v=function(){b("a.catalog-detail-link").on("click",function(a){a.stopPropagation(),a.preventDefault(),h.show();var b=this.id.split("-");cataloglibraryservices.catalogitem(parseInt(b[1]),function(a){a&&(f.searchView(h.searchView().SEARCH),f.itemClicks(a))})})},w=function(){var a=function(){var a="select.catalog-results-filter",c=0;b(a).on("change",function(){c=this.selectedIndex;switch(this.value){case"Title":d.sort(h.predicateBy("titleField")),n(d),c=this.selectedIndex;break;case"Author":d.sort(h.predicateBy("authorField")),n(d),c=this.selectedIndex;break;case"Publish":d.sort(h.predicateBy("datePublishedField")),n(d),c=this.selectedIndex;break;default:}b(a).prop("selectedIndex",c)})};p(),r(),s(),t(),u(),v(),a(),f.searchView(h.searchView().SEARCH),f.itemClicks()};a.init=function(a,b,c,d){g=d,e=c,f=b,h=a,g.init(h,e),f.init(h,e,g,null)},a.addReserveButtonClick=function(){r()},a.addMyListButtonClick=function(){s()},a.bindSearchButtonsEventCallback=function(a,b){d=b,w()},a.deselectAllCheckboxes=function(){q()}}(window.catalogcallbacks=window.catalogcallbacks||{},jQuery)
;"use strict",function(a,b,c){var d=null,e=null,f=null,g=null,h=null,i={RESERVE:0,ADD_MYLIST:1,RESERVE_ALL:2,ADD_MYLIST_ALL:3},j={click:i,selectedclick:null,Ids:new Array},k=null,l=function(a,b){e.setCookie(a,b)},m=function(a){var c=function(){b(".reserve-item-click").on("click",function(a){k=this.id.split("-")[2],j.Ids.push(k),j.selectedclick=j.click.RESERVE,e.show(),f.clickData(j),f.searchview=f.searchView(h),securitylibraryservices.authenticated(f.reserveCallback)})},d=function(){b(".mylist-item-click").on("click",function(a){k=this.id.split("-")[2],j.Ids.push(k),j.selectedclick=j.click.ADD_MYLIST,e.show(),f.clickData(j),f.searchView(h),securitylibraryservices.authenticated(f.mylistCallback)})},i=function(){b("button#back-to-search").on("click",function(a){a.stopPropagation(),a.preventDefault(),e.show(),setTimeout(function(){e.catalogTemplate().clearAvailabilty(),commonlibraryservices.setcontentview(h),e.showHide(h),e.hide()},g)})};a&&(c(),d(),i())};a.init=function(a,b,c,g){f=c,d=b,e=a,h=g},a.searchView=function(a){h=a},a.addReserveButtonClick=function(){addReserveClick()},a.addMyListButtonClick=function(){addMyListClick()},a.itemClicks=function(a){m(a)}}(window.catalogitemcallbacks=window.catalogitemcallbacks||{},jQuery)
;"use strict",function(a,b,c){var d=null,e=null,f=null,g=null,h=function(a,b){a?commonlibraryservices.setcontentview(b):commonlibraryservices.setcontentview(-1)},i=function(a,c,d){var i=a,j=function(){var a=null;return b("div.radio-info input:radio[name='optradio']").is(":checked")&&(a=b('div.radio-info input[type="radio"]:checked').val()),a},k=function(){var a=b("select.library-ddl :selected").map(function(a,c){var d=b(c).parent().attr("id").split("-")[2];return{titleId:d,libraryId:b(c).val()}}).get();return a.length>0?a:null},l=function(){b("#location-reserve").on("click",function(a){commonlibraryservices.show(),securitylibraryservices.authenticated(n)})},m=function(){b("button#pickuplocation-back-to").on("click",function(a){a.stopPropagation(),a.preventDefault(),f.show(),setTimeout(function(){f.catalogTemplate().clearAvailabilty();var a=parseInt(b("#backtoview").val());switch(a){case f.searchView().SEARCH_DEFAULT:f.showHide(f.searchView().SEARCH_DEFAULT);break;case f.searchView().SEARCH:f.showHide(f.searchView().SEARCH);break;case f.searchView().ITEM_DETAIL:f.showHide(f.searchView().ITEM_DETAIL);break;case f.searchView().ACCOUNT:f.showHide(f.searchView().ACCOUNT);break;default:}f.hide()},e)})},n=function(a){if(a){securitylibraryservices.yourStatus(!0);var d=b("#pickuplocationview").val();if(d==="radio"){var e=j();if(j()===null){commonlibraryservices.overlay(100,"Please select the library location to complete your reservation."),h(!1,-1);return}var f=commonlibraryservices.getLibraryName(e,"key");accountlibraryservices.createhold(i[0],e,function(a,b){var d=a?"This item has been reserved for you at {0} library.".replace("{0}",f!==null?f.value:""):"Unable to reserve this items. {0}".replace("{0}",b);return commonlibraryservices.overlay(100,d),h(a,c),g(a)})}else{var l=k();accountlibraryservices.createholds(l,function(a,b){return commonlibraryservices.overlay(100,a?"This items has been reserved for you.":"Unable to reserve this items."),h(a,c),g(a)})}}};d&&(l(),m())};a.init=function(a){f=a,e=f.getTimeout()},a.bindEvents=function(a,b,c,d){g=d,i(a,b,c)}}(window.pickuplocationcallbacks=window.pickuplocationcallbacks||{},jQuery)
;"use strict",function(a,b,c){var d=null,e=null,f=null,g=null,h=null,i={RESERVE:0,ADD_MYLIST:1,RESERVE_ALL:2,ADD_MYLIST_ALL:3},j=function(a,b){commonlibraryservices.setCookie(a,b)},k=function(a,b){switch(b.selectedclick){case b.click.ADD_MYLIST:case b.click.ADD_MYLIST_ALL:m(a);break;case b.click.RESERVE:case b.click.RESERVE_ALL:l(a);break;default:e.showHide(h)}securitylibraryservices.clearloginTemplate(),e.hide()},l=function(a){if(!a)e.showHide(e.searchView().LOGIN),securitylibraryservices.goToLoginPage(k,g);else{e.showHide(e.searchView().PICKUP_LOCATION),e.show();var b=h;sharedlibraryservices.populatePickupLocation(g.Ids,b,function(a){a&&d.bindEvents(g.Ids,b,!0,function(a){securitylibraryservices.yourStatus(!0)})})}},m=function(a){a?(e.show(),e.showHide(h),accountlibraryservices.savemylist(g.Ids,"create",function(a){var b=a?"My List items has been successfully updated.":"Unable to update My List items.";e.overlay(100,b),j(a,h)})):(j(!1,-1),e.showHide(commonlibraryservices.searchView().LOGIN),securitylibraryservices.goToLoginPage(k,g))};a.init=function(a,b){d=b,e=a},a.reserveCallback=function(a){l(a)},a.mylistCallback=function(a){m(a)},a.loginCallback=function(a,b){k(a,b)},a.searchView=function(a){h=a},a.clickData=function(a){g=a}}(window.sharedcallbacks=window.sharedcallbacks||{},jQuery)
;"use strict",function(a,b,c){function n(a,b){var c=new Image;c.src=a,c.onload=function(){var a=c.width,d=c.height;b(!0,a,d)},c.onerror=function(){b(!1,0,0)}}var d=null,f=null,g=null,h=null,i=null,j=null,k=null,l={RESERVE:0,ADD_MYLIST:1},m={click:l,selectedclick:null,Ids:new Array},o=function(){var a=function(){k=d[j].titleIDField,cataloglibraryservices.selectedHotList(k,function(a,b){a&&(i.catalogTemplate().populateWhatsNew(d,b),p()),i.hide()})};commonlibraryservices.show(),commonlibraryservices.catalogTemplate().clearWhatsNew(),setTimeout(function(){a()},300)},p=function(){var a=function(){b("a.hotlist-detail-link").on("click",function(a){a.stopPropagation(),a.preventDefault(),i.show();var b=this.id.split("-");cataloglibraryservices.catalogitem(parseInt(b[1]),function(a){a&&(g.searchView(i.searchView().SEARCH_DEFAULT),g.itemClicks(a))})})},c=function(){b(".hotlist-reserve").on("click",function(a){k=this.id.split("-")[2],m.Ids=new Array,m.Ids.push(k),m.selectedclick=m.click.RESERVE,i.show(),h.clickData(m),h.searchView(i.searchView().SEARCH_DEFAULT),securitylibraryservices.authenticated(h.reserveCallback)})},d=function(){b(".hotlist-mylist").on("click",function(a){k=this.id.split("-")[2],m.Ids.push(k),i.show(),h.clickData(m),h.searchView(i.searchView().SEARCH_DEFAULT),securitylibraryservices.authenticated(h.mylistCallback)})},e=function(){b("a.hotlist-link").bind("click",function(a){j=parseInt(this.id.split("-")[1]),o(),a.preventDefault()})};c(),d(),a(),e()};a.init=function(a,b,c,e,j){d=a,h=j,f=e,g=c,i=b,h.init(i,f),g.init(i,f,h,null),p()},a.replaceImage=function(a){var b="/siteElements/channelshift/content/images/library/no-image.png";a.onload=null,n(a.src,function(c,d,e){a.src=c&&d>10?a.src:b})},a.iframeClick=function(a){j=a,o(),e.preventDefault()}}(window.newbookscallbacks=window.newbookscallbacks||{},jQuery)
