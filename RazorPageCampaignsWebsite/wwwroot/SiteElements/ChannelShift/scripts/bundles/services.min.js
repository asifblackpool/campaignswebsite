;(function(a,b,c){function f(a,b,c){var d=new Date,e=new Date;if(c===null||c===0)c=1;e.setTime(d.getTime()+864e5*c),document.cookie=a+"="+window.escape(b)+";expires="+e.toGMTString()}function g(a){try{var b=" "+document.cookie,c=b.indexOf(" "+a+"=");c===-1&&(c=b.indexOf(";"+a+"="));if(c===-1||a==="")return"";var d=b.indexOf(";",c+1);return d===-1&&(d=b.length),window.unescape(b.substring(c+a.length+2,d))}catch(e){return"error"}}var d="outdatedbrowser",e="set",h=!1,i=function(){var a=this,b=navigator.userAgent.toLowerCase();b.indexOf("msie")!==-1&&(a.ie={version:parseInt(b.split("msie")[1].trim().substr(0,1))})},j=function(){try{var a=function(a){try{var c=document.getElementById(a);c.addEventListener("load",function(){c.style="cursor:pointer;";var a=c.contentDocument;a.onclick=function(a){b("#outdated-browser").css("display","none"),f(d,e,240),a.preventDefault()}},!1)}catch(g){}};a("close-button-svg");if(i!==null&&i.ie.version<9){var c=g(d);c!==e&&(a("close-button-svg"),b("#outdated-browser").css("display","block"))}}catch(h){}},k=function(){i.ie&&i.ie.version<10&&(console.log("IE "+i.ie+" version "+i.ie.version),h=!0),h&&(console.log("replace place holders"),b("input[placeholder]").each(function(){var a=b(this);b(a).val(a.attr("placeholder")),b(a).focus(function(){a.val()===a.attr("placeholder")&&a.val("")}),b(a).blur(function(){(a.val()===""||a.val()===a.attr("placeholder"))&&a.val(a.attr("placeholder"))})}))};a.init=function(){k(),j()}})(window.ieBrowser=window.ieBrowser||{},jQuery)
;(function(a,b,c){var d=function(){b(window).scroll(function(){b(this).scrollTop()>100?b(".scrollToTop").fadeIn():b(".scrollToTop").fadeOut()}),b(".scrollToTop").click(function(a){return b("html, body").animate({scrollTop:0},800),a.preventDefault(),!1})},e=function(a,c){var d=b("."+a).position();return b("html, body").animate({scrollTop:d.top},800),c.preventDefault(),!1};a.init=function(){d()},a.ScrollToByClass=function(a,b){return e(a,b)}})(window.scrollerservice=window.scrollerservice||{},jQuery)
;(function(dateservices,$,undefined){function hmsToSecondsOnly(a){var b=a.split(":"),c=0,d=1;while(b.length>0)c+=d*parseInt(b.pop(),10),d*=60;return c}function absVal(a){return a<0?-a:a}var getTimeZoneOffSet=function(){var a=new Date,b=a.getTimezoneOffset();return b%60===0?b/60:0},convertSqlDate=function(a){var b=a.split("T"),c=b[0].split("-"),d=b[1].split(":"),e=parseInt(c[0]),f=parseInt(c[1])-1,g=parseInt(c[2]),h=d[0],i=d[1],j=d[2];return new Date(e,f,g,h,i,j)},convertStringDate=function(a){var b=a.split(" "),c=b[0].split("-"),d=b[1].split(":"),e=parseInt(c[0]),f=parseInt(c[1])-1,g=parseInt(c[2]),h=parseInt(d[0]),i=parseInt(d[1]),j=parseInt(d[2]),k=getTimeZoneOffSet();return h=k<0?h+parseInt(absVal(k)):h,h=k>0?h+parseInt(absVal(k)):h,new Date(g,f,e,h,i,j)},stringToDate=function(a,b,c){var d=b.toLowerCase(),e=d.split(c),f=a.split(c),g=e.indexOf("mm"),h=e.indexOf("dd"),i=e.indexOf("yyyy"),j=parseInt(f[g]),k=parseInt(f[i]),l=parseInt(f[h]);j-=1;var m=new Date(k,j,l);return m},displayDate=function(_date,format){var day=_date.getDate(),month=_date.getMonth()+1,year=_date.getFullYear();return day<10&&(day="0"+day),month<10&&(month="0"+eval(month)),format=format.replace("yyyy",year).replace("dd",day).replace("mm",month),format},getDay=function(a){var b=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];return console.log("getDay() -> "+b),b[a]},getMonth=function(a){var b=["January","February","March","April","May","June","July","August","September","October","November","December"];return b[a]},nth=function(a){if(a>3&&a<21)return"th";switch(a%10){case 1:return"st";case 2:return"nd";case 3:return"rd";default:return"th"}},formatSeconds=function(a){var b=parseInt(a/3600)%24,c=parseInt(a/60)%60,d=a%60;return(b<10?"0"+b:b)+":"+(c<10?"0"+c:c)+":"+(d<10?"0"+d:d)};dateservices.convertToDate=function(a,b,c){return stringToDate(a,b,c)},dateservices.formatDate=function(a,b,c){return getDay(a)+", "+a+nth(a)+" "+getMonth(b)+", "+c},dateservices.DisplayDate=function(a,b){return displayDate(a,b)},dateservices.convertSQLDate=function(a,b){return convertSqlDate(a,b)},dateservices.convertStringDate=function(a){return convertStringDate(a)},dateservices.FormatSeconds=function(a){return formatSeconds(a)},dateservices.ConverToSeconds=function(a){return hmsToSecondsOnly(a)}})(window.dateservices=window.dateservices||{},jQuery)
;(function(a,b,c){var d="table.tbl-responsive",e=function(){var a=[],b=document.querySelectorAll(d+" th"),c=document.querySelectorAll(d+" tr");for(var e=0;e<b.length;e++){var f=b[e];a.push(f.textContent.replace(/\r?\n|\r/,""))}for(var g=0;g<c.length;g++){var h=c[g];for(var i=0;i<h.length;i++){var j=h.cells[i];j.setAttribute("data-th",a[i])}}};a.init=function(){e()}})(window.tableservices=window.tableservices||{},jQuery)
;var utilities=function(a){var b={dropdown:{},unorderdList:{},helper:{}};return b.dropdown.appendOptions=function(b,c){var d=a("#"+b);d.append(a(new Option("-- Please Select --","0"))),a.each(c,function(b,c){d.append(a(new Option(c.Text,c.Value)))})},b.dropdown.removeAllOptions=function(b){a("#"+b).empty()},b.unorderdList.appendList=function(b,c){a.each(c,function(c,d){a("#"+b).append("<li>"+d.Text+"</li>")})},b.splitString=function(a,b){try{var c=a.split(",");return c.length>b?c[b]:a}catch(d){alert("module.splitString() => error: "+d.message)}},b.validateUKPostCode=function(a){if(a!==""&&a.length>2){var b=a.substring(0,2).toUpperCase(),c=/^(FY)/;if(!b.match(c))return"Post code must start with FY.";a=a.replace(/\s/g,"");var d=/[A-Z]{1,2}[0-9][0-9A-Z]?\s?[0-9][A-Z]{2}/gi,e=d.test(a);return e?"":"You have entered an invalid post code for Blackpool."}return"Please provide a valid Blackpool post code."},b.validateEmailAddress=function(a){var b=/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;return b.test(a)?"":"Please provide a valid email address."},b.searchQuery=function(a){var b=a.trim();b!==""&&(document.location.href="/Search-Results.aspx?search_keywords="+encodeURIComponent(b))},b.ajaxRequest=function(){var a=["Msxml2.XMLHTTP","Microsoft.XMLHTTP"];if(!window.ActiveXObject)return window.XMLHttpRequest?new XMLHttpRequest:null;for(var b=0;b<a.length;b++)try{return new window.ActiveXObject(a[b])}catch(c){}},b.helper.sortObjArray=function(a,b){a.sort(function c(a,c){return a[b]<c[b]?-1:a[b]>c[b]?1:0})},b.helper.removeDuplicatesFromObjArray=function(a,b){var c=[];return a.reduce(function(a,d){if(a[b]!==d[b])return c.push(d),d},[]),c},b}(jQuery);(function(a,b,c){var d={search:!1,menu:!1},e=null,f=function(){var a=!1,c=function(){d.menu=!0,i(),b("#menu-anchor-icon").toggleClass("mobile-nav-icon mobile-close-icon"),h()},f=function(){i(),b("#menu-anchor-icon").toggleClass("mobile-nav-icon mobile-close-icon"),d.menu=!1},g=function(){a?(b.sidr("open","sidr-menu"),a=!1):(b.sidr("close","sidr-menu"),a=!0)};e=b("#toggle-menu").sidr({name:"sidr-menu",side:"right",source:"#navigation",displace:!0,speed:"200",onOpen:function(){c()},onClose:function(){f()}}),b("#toggle-menu").on("click",function(a){g(),a.preventDefault(),a.stopPropagation()}),g()},g=function(){b("#toggle-search").click(function(){return i(),d.search||b("#search-box-inner").css({height:"155px"}),b(".toggle-search").toggle("slow"),b("#search-anchor-icon").toggleClass("mobile-search-icon mobile-close-icon"),d.search=!d.search,!1}),b("#home-show-hide-services").click(function(){var a=function(){var a={id:"more-services-icon",up:"arrowup-white.svg",down:"arrowdown-white.svg",path:"/SiteElements/ChannelShift/content/images/mobile/"},c=b("#"+a.id).attr("src"),d=c.substr(c.lastIndexOf("/")+1);d==="arrowdown-white.svg"?(b(".home-icon").find("*").removeClass("mobile-hidden"),b("#"+a.id).attr("src",a.path+a.up)):(b(".home-icon").find("div:nth-child(n+7)").addClass("mobile-hidden"),b("#"+a.id).attr("src",a.path+a.down))};a()})},h=function(){b("#search-anchor-icon").removeClass(),b("#search-anchor-icon").addClass("mobile-search-icon"),d.search&&(b(".toggle-search").toggle("slow"),d.search=!1)},i=function(){b("#search-box-inner").css({height:""}),d.menu&&e.click()};a.init=function(){console.log("home services initialisation"),f(),g()}})(window.homeservices=window.homeservices||{},jQuery),function(a,b,c){function d(a,c){b.each(c,function(a,b){b.photosmallurl=b.photosmallurl.replace("http","https")});var d=Handlebars.compile(b("#councillor-template").html());b(".councillor-placeholder").html(d({apidata:c,wardTitle:a})),b("#councillor-loading-indicator").hide()}function e(a){var c=[],e=function(){b(".councillor-placeholder").html(""),b("#councillor-loading-indicator").show()};e(),b.get(window.commonservices.Config().democracyUrl+"CouncillorsByArea?postcode="+a,function(a,c){console.log("Data: "+a+"\nStatus: "+c);var e=b.parseJSON(a),f=JSON.search(e,"//wardtitle/text()"),g=JSON.search(e,"//councillor");d(f,g)}).fail(function(){d("",c)})}a.init=function(a){console.log("call democracy init "+a),e(a)}}(window.democracy=window.democracy||{},jQuery),function(a,b,c){var d="polling-template",e="polling-placeholder",f="polling-address-template",g="polling-station-address",h=function(a){function h(){b.when(b.ajax(f)).done(function(a){a!==null?g(b.parseJSON(a)):g(null)}).fail(function(){g(null)})}var c=null,f=window.commonservices.Config().pollingStationUrl+"properties?postcode="+a,g=function(a){var c=Handlebars.compile(b("#"+d).html()),f=a!==null?a:[];b("."+e).html(c({apiproperties:f})),b("#polling-loading-indicator").hide(),k()};j(),c&&clearTimeout(c),c=setTimeout(h,3e3)},i=function(a){function h(a){var c=Handlebars.compile(b("#"+f).html()),d=a!==null?a:[];b("."+g).html(c({apipolling:d}))}function i(){b.when(b.ajax(d)).done(function(a){a!==null?h(e(b.parseJSON(a))):h(null)}).fail(function(){h(null)})}var c=null,d=window.commonservices.Config().pollingStationUrl+"PollingStation?id="+a,e=function(a){var b=[],c={name:"",address:""};if(a!==null){var d="";d=a.AddressLine1!==null?a.AddressLine1:"",d=a.AddressLine2!==null?d+", "+a.AddressLine2:d,d=a.AddressLine3!==null?d+", "+a.AddressLine3:d,d=a.AddressLine4!==null?d+", "+a.AddressLine4:d,d=a.AddressLine5!==null?d+", "+a.AddressLine5:d,d=a.AddressLine6!==null?d+", "+a.AddressLine6:d,d=a.AddressLinePostCode!==null?d+", "+a.AddressLinePostCode:d,c.address=d,c.name=a.AddressLine1!==null?a.AddressLine1:"",b.push(c)}return b};c&&clearTimeout(c),c=setTimeout(i,500)},j=function(){window.commonservices.Config().includePollingStation&&b("."+g).html("")},k=function(){b("#streetDropDownList").on("change",function(a){j();var b=parseInt(this.value);b>0&&i(b),a.preventDefault()})};a.init=function(a){window.commonservices.Config().includePollingStation?(console.log("call voting init "+a),h(a)):b("#polling-panel").hide()}}(window.votingservices=window.votingservices||{},jQuery),function(a,b,c){var d=function(a){var c=[],d=function(a){var c=Handlebars.compile(b("#bin-template").html());b(".bin-placeholder").append(c({apidata:a,count:a.length})),b("#bin-loading-indicator").hide()},e=function(){b(".bin-placeholder").html(""),b("#bin-loading-indicator").show()};e(),b.post(window.commonservices.Config().veoliaUrl+"BinCollection",{"":a},function(a,b){console.log("Bin collection Data: "+a+"\nStatus: "+b),d(a)}).fail(function(){d(c)})};a.init=function(a){console.log("call waste services init postcode "+a),d(a)}}(window.wasteservices=window.wasteservices||{},jQuery),function(a,b,c){var d=function(a){var c=[],d=null,e=function(){var a=Handlebars.compile(b("#park-template").html());b(".parks-placeholder").append(a({apidata:c})),b("#park-loading-indicator").hide()},f=function(){b(".parks-placeholder").html(""),b("#park-loading-indicator").show()},g=function(){b.get(window.commonservices.Config().googleUrl+"CurrentParks",function(a,b){console.log("data "+a+"  status"+b),d=a,h()})},h=function(){b.get(window.commonservices.Conf.googleUrl+"Place",{postcode:a,type:"park",radius:"3000"},function(a,f){console.log("status is "+f);var g=b.parseJSON(a),h=JSON.search(g,'//results[contains(name, "Park") and not (contains(name,"Caravan"))]');b.each(h,function(a,b){var e=JSON.search(d,'//Parks[Name="'+b.name+'"]');if(b.name.indexOf("Holiday")<1){var f={name:b.name,vicinity:e.length===1?e[0].Address:b.vicinity,url:e.length===1?e[0].pageLink:"#"};c.push(f)}}),utilities.helper.sortObjArray(c,"name"),c=utilities.helper.removeDuplicatesFromObjArray(c,"name"),e()}).fail(function(){e()})};f(),g()};a.init=function(a){window.commonservices.Config().includeGoogleServices?(console.log("call google services init postcode "+a),d(a)):b("#park-panel").hide()}}(window.googleservices=window.googleservices||{},jQuery),function(a,b,c){var d=utilities,e=function(){var a=b("#sign-in-form-template"),c=b("#sign-in-form-placeholder");if(c.length)console.log("template exists");else{console.log("add sign in template");var d=Handlebars.compile(a.html());c="<div id='sign-in-form-placeholder' style='display:none'></div>",b("body").append(c),b("#sign-in-form-placeholder").append(d({apiData:""}))}};a.proxySubmit=function(){var c=b("#proxy-postcode").val(),d=b("#proxy-email").val(),e=a.submitform(c,d);e.email===""&&e.postcode===""?(b("#Email").val(d),b("#cd_POSTCODE").val(c),b('form[name="signup"]').submit()):(b("#proxy-email-error").html(e.email),b("#proxy-postcode-error").html(e.postcode))},a.init=function(){e()},a.submitform=function(a,b){var c="",e={email:"",postcode:""};return c=d.validateUKPostCode(a),c!==""&&(e.postcode=c,c=""),c=d.validateEmailAddress(b),c!==""&&(e.email=c,c=""),e}}(window.signInServices=window.signInServices||{},jQuery)
;(function(a,b,c){var d="https://www.youtube.com/embed/{0}?start={1}{2}",e="http://democracy.blackpool.gov.uk/ieListDocuments.aspx?CId=134&MId={0}",f=function(a){var c=[];return Array.isArray(a)?b.each(a,function(a,b){c.push(b)}):c.push(a),c},g=function(){Array.isArray||(Array.isArray=function(a){return Object.prototype.toString.call(a)==="[object Array]"})},h=function(){console.log("call webchatservices -> showVideo()");var a="https://www.youtube.com/embed/";b("a.you-tube-link").on("click",function(c){console.log("click");var d=b(".iframe-wrapper").find("iframe"),e=this.href;e!==null&&(e=e.substring(e.lastIndexOf("/")+1),e=a+e,d[0].src=e+"&autoplay=1",d[0].width=900),window.scrollerservice.ScrollToByClass("iframe-wrapper",c),c.preventDefault()})},i=function(a){a.length===8&&(a=a.replace("00:00:00",""));if(a.length>3){var b=a.substring(0,3);if(b==="00:")return a.substring(3,a.length)}return a},j=function(){var a={link:"",text:""},c={link:"",text:""},g=null,j=[],k=function(a){var c=b('<iframe id="iframe-webcast" src="'+a+'" frameborder="0" allowfullscreen="allowfullscreen" width="100%"></iframe>');b(".iframe-wrapper").html(c)},l=function(a,c,d,e){var f={isLatest:e,Id:b("#current-hidden-videoId").val(),Title:b("#current-hidden-title").val()},g=Handlebars.compile(b("#webcast-video-timestamp-template").html());b("#webcast-video-placeholder").html(g({apivideodata:a,apitimestampdata:c,democracy:d,apidefault:f})),b("#iframe-loading-indicator").hide(),h()},m=function(a){var c=Handlebars.compile(b("#webcast-video-links-template").html());b("#webcasts-links-placeholder").html(c({apidata:a}))},n=function(){b("#webcasts-video-placeholder").html(""),b("#iframe-loading-indicator").show(),b(".iframe-wrapper").find("iframe").remove()},o=function(f,g){var h="";while(j.length>0)j.pop();if(f!==null){b("#current-title").html(f.Title),f.DemocracyMeetingId>0&&(h=e.replace("{0}",f.DemocracyMeetingId)),k(d.replace("{0}",f.VideoKey).replace("{1}",0).replace("{2}",""));if(f.TimeStamps.length>0){var m=1;b.each(f.TimeStamps,function(c,e){var g=b.extend({},a),h=i(window.dateservices.FormatSeconds(e.TimeStamp));g.title=m+". "+e.Title+" "+h,h!==""?g.link=d.replace("{0}",f.VideoKey).replace("{1}",e.TimeStamp).replace("{2}",";autoplay=1"):g.link="",j.push(g),m++})}c.link=h,c.text=h.replace("http://",""),l(f,j,c,g),h=""}},p=function(a){var c=b("#current-hidden-videoId").val(),d=parseInt(c)===parseInt(a)?!0:!1;n(),b.get(window.commonservices.Config().webCasting+"Video/"+a,function(a,b){console.log("get video by id success");var c=f(a),e=c.length>0?c[0]:null;setTimeout(function(){o(e,d),r()},3e3)}).fail(function(){alert("get video by Id fail fetch")})},q=function(){var a=window.dateservices.DisplayDate(new Date,"yyyy-mm-dd");console.log("get video by date"),n(),b.get(window.commonservices.Config().webCasting+"allVideosByDate/"+a,function(a,c){var d=f(a);console.log("ajax status is "+c),g=d.length>0?d[0]:null,g!==null&&(b("#current-hidden-videoId").val(g.Id),b("#current-hidden-title").val(g.Title),setTimeout(function(){o(g,!0)},3e3)),d.length>0&&(d.shift(),m(d),r())}).fail(function(a,c,d){if(a.getResponseHeader("Content-Type").indexOf("application/json")>-1){var e=b.parseJSON(a.responseText);alert(e.Message)}else alert("Fatal error")})},r=function(){b("a.other-webcast-link").on("click",function(a){var c=b(this).attr("id").split("_")[1];console.log("other webcast click link "+c),p(c),a.preventDefault()})};q()};a.init=function(){g(),j()},a.autoResize=function(a){var b,c;document.getElementById&&(b=document.getElementById(a).contentWindow.document.body.scrollHeight,c=document.getElementById(a).contentWindow.document.body.scrollWidth),document.getElementById(a).height=b+"px",document.getElementById(a).width=c+"px"}})(window.webcastvideoservices=window.webcastvideoservices||{},jQuery)
;(function(a,b,c){function e(){d()}function f(){var a=new a;a.setAccGUID("F6FC8B4F-DBED-4B92-BE66-41AFBDD360DF"),a.setWSGUID("97ee9365-b18d-4ea7-b90e-61e5fa7e4736"),a.setWFGUID("8a43196e-a411-4b64-8474-da649c5ef21b"),a.setPopupWindowWFGUID("a4cf0c79-0ba3-482d-9c33-420273f43127"),a.setDockPosition("BOTTOM"),a.setBtnStyle("position:fixed; border:none; bottom:0em; right:1em;"),a.setIdentity("Embedded Chat"),a.Initilize()}var d=function(){var a=document.getElementsByTagName("head")[0],b=document.createElement("script");b.type="text/javascript",b.charset="utf-8",b.id="srcC4AWidget",b.defer=!0,b.async=!0,b.src="https://prod3si.click4assistance.co.uk/JS/ChatWidget.js",a&&a.appendChild(b)};a.init=function(){e()},a.loadWidget=function(){f()}})(window.webchatservice=window.webchatservice||{},jQuery)
